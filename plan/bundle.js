!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}n(1);var o=n(5),i=r(o);window.SIM=i["default"]},function(t,e,n){var r=n(2);"string"==typeof r&&(r=[[t.id,r,""]]);n(4)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){e=t.exports=n(3)(),e.push([t.id,"body{padding:0;margin:0}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=h[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(c(r.parts[i],e))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(c(r.parts[i],e));h[r.id]={id:r.id,refs:1,parts:a}}}}function o(t){for(var e=[],n={},r=0;r<t.length;r++){var o=t[r],i=o[0],a=o[1],u=o[2],s=o[3],c={css:a,media:u,sourceMap:s};n[i]?n[i].parts.push(c):e.push(n[i]={id:i,parts:[c]})}return e}function i(t,e){var n=g(),r=m[m.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),m.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function a(t){t.parentNode.removeChild(t);var e=m.indexOf(t);e>=0&&m.splice(e,1)}function u(t){var e=document.createElement("style");return e.type="text/css",i(t,e),e}function s(t){var e=document.createElement("link");return e.rel="stylesheet",i(t,e),e}function c(t,e){var n,r,o;if(e.singleton){var i=b++;n=y||(y=u(e)),r=l.bind(null,n,i,!1),o=l.bind(null,n,i,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(e),r=f.bind(null,n),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=u(e),r=p.bind(null,n),o=function(){a(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}function l(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=w(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function p(t,e){var n=e.css,r=e.media;e.sourceMap;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function f(t,e){var n=e.css,r=(e.media,e.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var h={},d=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},v=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),g=d(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,b=0,m=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=v()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var n=o(t);return r(n,e),function(t){for(var i=[],a=0;a<n.length;a++){var u=n[a],s=h[u.id];s.refs--,i.push(s)}if(t){var c=o(t);r(c,e)}for(var a=0;a<i.length;a++){var s=i[a];if(0===s.refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete h[s.id]}}}};var w=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function o(t){return t&&t.__esModule?t:{"default":t}}function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(){return{ports:[{id:(0,g.uniqueId)(),position:Math.PI,type:"input",name:"input"},{id:(0,g.uniqueId)(),position:0,type:"output",name:"output"}],id:(0,g.uniqueId)(),children:[],name:"Object",type:"gate",subType:"",parent:0,width:190,height:180,showChildren:!0,x:0,y:0,outputData:[],dropTarget:!1,isDragging:!1,additionalPanels:[],customAttributes:{},rules:{canAddInputPort:!0,canRenameInputPort:!0,canMoveInputPort:!0,canDeleteInputPort:!0,canAddOutputPort:!0,canRenameOutputPort:!0,canMoveOutputPort:!0,canDeleteOutputPort:!0,maxOutputPortsNumber:1/0,maxInputPortsNumber:1/0,minOutputPortsNumber:0,minInputPortsNumber:0,canAddOutputData:!0,canRenameOutputData:!0,canDeleteOutputData:!0,elementMapperEnabled:!0,expressionEditorEnabled:!0,outputDataEditorEnabled:!1,outputPortValidation:".*?",inputPortValidation:".*?"}}}Object.defineProperty(e,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},p=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=n(6),h=o(f),d=n(7),v=o(d),g=n(8),y=o(g);n(10);var b=n(11),m=o(b),w=n(15),j=r(w),x=n(31),O=o(x),_=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];u(this,t),this.state=l({},this._getInitialState(),n),this.ensureViewportAttrs(),this.history=[this.getCleanState()],this.historyStep=0,this.recordCount=0,this.indexCache={},this._listeners={"object-click":[],"object-dblclick":[],"object-properties-click":[],"object-bookmark-click":[],"object-create":[],"object-change":[],"object-delete":[],stateChange:[]},e&&v["default"].render(h["default"].createElement(m["default"],{controller:this}),document.getElementById(e))}return p(t,[{key:"_getInitialState",value:function(){return{width:window.innerWidth,height:window.innerHeight,objects:[],connects:[],tempConnect:{show:!1,startPos:null,startPortId:null},selector:{show:!1,x:null,y:null,width:null,height:null},panDragger:{show:!1,x:null,y:null},advancedProperties:{show:!1},showCreateChipPrompt:!1,selectedObjects:[],selectedConnects:[],searchMatchedObjects:[],viewport:{scale:1,scaleDelta:1.1,maxScale:3,x:0,minX:-100,minY:-100,maxX:1e3,maxY:1e3,y:0},tooltip:{x:0,y:0,text:"",show:!1},multipleSelectionMode:!1,settingsIcon:null,settingsTooltipText:"Advanced Properties",bookmarkIcon:null,bookmarkTooltipText:"Bookmark",goToReferenceIcon:null,goToReferenceTooltipText:"go to reference",fitViewportIcon:null,fitViewportTooltipText:"fit viewport",drillUpIcon:null,drillUpTooltipText:"drill up",drillDownIcon:null,drillDownTooltipText:"drill down",maxFontSize:1/0,autoScrollOffset:25,tooltipDelay:100,expressionTree:{}}}},{key:"toJSON",value:function(){var t=this,e={};return e.Nodes=this.state.objects.map(function(e){var n={IntegrityInformation:{}};return n.NodeName=e.name,n.NodeId=e.id,n.NodeType=e.subType||e.type,n.IntegrityInformation.IsReference=!!e.referenceOf,n.FunctionalInformation={},n.FunctionalInformation.Attributes={},y["default"].forOwn(e.customAttributes,function(t,e){y["default"].isString(t)?n.FunctionalInformation.Attributes[e]="'"+t+"'":n.FunctionalInformation.Attributes[e]=t}),-1===n.NodeType.toLowerCase().indexOf("chip")&&(n.FunctionalInformation.PortMapping=[],e.outputData.forEach(function(t){n.FunctionalInformation.PortMapping.push({Target:t.name,IsMandatory:t.isMandatory?"`true`":"`false`",Source:t.source})})),n.IntegrityInformation.InputPorts=[],n.IntegrityInformation.OutputPorts=[],e.ports.forEach(function(t){"input"===t.type?n.IntegrityInformation.InputPorts.push({Position:t.position,PortName:t.name,PortId:t.id,IsMandatory:t.isMandatory?"`true`":"`false`"}):"output"===t.type&&n.IntegrityInformation.OutputPorts.push({Position:t.position,PortName:t.name,PortId:t.id})}),n.IntegrityInformation.ChildrenIds=e.children,n.IntegrityInformation.ParentId=e.parent,n.IntegrityInformation.ChildConnections=[],n.IntegrityInformation.InputConnections=[],e.ports.forEach(function(r){t.state.connects.forEach(function(o){var i=void 0,a=void 0;if(o.ports[0]===r.id)i=t.getObjectByPort(o.ports[1]),a=o.ports[1];else{if(o.ports[1]!==r.id)return;i=t.getObjectByPort(o.ports[0]),a=o.ports[0]}e.parent===i.parent&&"input"===r.type?n.IntegrityInformation.InputConnections.push({SourcePort:i.id+"."+a,TargetPortId:r.id}):e.id===i.parent&&(n.IntegrityInformation.ChildConnections=n.IntegrityInformation.ChildConnections||[],n.IntegrityInformation.ChildConnections.push({ChildPort:i.id+"."+a,ParentPortId:r.id}))})}),n.GraphicalInformation={},n.GraphicalInformation.X=e.x,n.GraphicalInformation.Y=e.y,n.GraphicalInformation.WidthRatio=e.width,n.GraphicalInformation.HeightRatio=e.height,n}),e}},{key:"fromJSON",value:function(t){var e=t;"string"==typeof t&&(e=JSON.parse(t)),this.indexCache={};var n=[],r=[];e.Nodes.forEach(function(t){var e=s();e.name=t.NodeName,e.id=t.NodeId,e.subType=t.NodeType,"chip"===t.NodeType&&(e.type="chip"),e.isReference=t.IntegrityInformation.IsReference,e.customAttributes={},y["default"].forOwn(t.FunctionalInformation.Attributes,function(t,n){y["default"].isString(t)&&"'"===t[0]&&"'"===t[t.length-1]?e.customAttributes[n]=t.slice(1,t.length-1):e.customAttributes[n]=t}),(t.FunctionalInformation.PortMapping||[]).forEach(function(t){e.outputData.push({name:t.Target,type:"string",isMandatory:"`true`"===t.IsMandatory,source:t.Source})}),e.ports=[],(t.IntegrityInformation.InputPorts||[]).forEach(function(t){e.ports.push({position:t.Position,name:t.PortName,id:t.PortId,isMandatory:"`true`"===t.IsMandatory,type:"input"})}),(t.IntegrityInformation.OutputPorts||[]).forEach(function(t){e.ports.push({position:t.Position,name:t.PortName,id:t.PortId,type:"output"})}),e.children=t.IntegrityInformation.ChildrenIds,e.parent=t.IntegrityInformation.ParentId,e.x=t.GraphicalInformation.X,e.y=t.GraphicalInformation.Y,e.width=t.GraphicalInformation.WidthRatio,e.height=t.GraphicalInformation.HeightRatio,n.push(e),t.IntegrityInformation.InputConnections.forEach(function(t){r.push({id:(0,g.uniqueId)(),ports:[t.SourcePort.split(".")[1],t.TargetPortId],isMandatory:t.IsMandatory})}),t.IntegrityInformation.ChildConnections.forEach(function(t){r.push({id:(0,g.uniqueId)(),ports:[t.ChildPort.split(".")[1],t.ParentPortId],isMandatory:t.IsMandatory})})}),this.setState({objects:n,connects:r}),this.ensureViewportAttrs()}},{key:"getCleanState",value:function(){var t=this,e=["objects","connects"],n={};return e.forEach(function(e){n[e]=t.state[e]}),n}},{key:"trigger",value:function(t,e){return this._listeners[t]?void this._listeners[t].forEach(function(t){return t.apply(null,e)}):(console.error("Unrecognized event: "+t+" for trigger. Skipping it."),void console.log("Supported events are: "+Object.keys(this._listeners).join(", ")))}},{key:"on",value:function(t,e){return this._listeners[t]?void this._listeners[t].push(e):(console.error("Unrecognized event: "+t+". Skipping it."),void console.log("Supported events are: "+Object.keys(this._listeners).join(", ")))}},{key:"attr",value:function(t,e){return void 0===e?this.state[t]:(this.setState(a({},t,e)),this)}},{key:"setState",value:function(t){return t.objects&&t.objects.length!==this.state.objects.length&&(this.indexCache={}),this.state=l({},this.state,t),this.requestTriggerStateChange(),this}},{key:"commit",value:function(){this.trigger("stateChange")}},{key:"requestTriggerStateChange",value:function(){var t=this;this.waiting||(this.waiting=!0,setTimeout(function(){t.waiting=!1,t.trigger("stateChange")}))}},{key:"createObject",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=arguments[1],n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=t.type;if("chip"!==r&&"gate"!==r)return console.error("Unknow object type. "+r+". Can not create object."),null;var o=this.state.viewport,a=y["default"].merge(s(),l({},y["default"].cloneDeep(t),{id:t.id||(0,g.uniqueId)(),type:r}));t.ports&&(a.ports=t.ports),t.outputData&&(a.outputData=t.outputData),e&&(a.x=o.x+e.x/o.scale,a.y=o.y+e.y/o.scale),t.ports&&(a.ports=t.ports.map(function(t){return l({},t,{id:t.id||(0,g.uniqueId)()})})),"chip"===r&&(a.width*=2,a.height*=2),"gate"===r&&(a.subType=a.subType||"amplifier");var u=y["default"].find(this.state.objects,function(t){return t.id===a.id?!1:t.name===a.name});u&&"chip"===a.type&&(a.name=(a.type+"  "+a.id).toUpperCase()),u&&"gate"===a.type&&(a.name=(a.type+" "+a.subType+" "+a.id).toUpperCase()),this.preUndo(),this.setState({objects:[a].concat(i(this.state.objects))}),this.indexCache={};var c=n&&this.getDropTarget(a.id);if(c){var p=this.getObjectAbsolutePosition(c.id);this.addChildObject(c.id,a.id,{x:a.x-p.x,y:a.y-p.y})}return this.postUndo(),this.trigger("object-create",[a]),a}},{key:"updateObject",value:function(t,e,n,r){var o=this,a=this.getObjectIndex(t),u=this.state.objects[a],s=l({},u,e,{customAttributes:y["default"].merge({},u.customAttributes,e.customAttributes),rules:y["default"].merge({},u.rules,e.rules)});n||this.preUndo();var c=["ports","id","children","name","parent","width","height","x","y","showChildren","dropTarget","isDragging","referenceOf"],p={},f=!1;return y["default"].forOwn(e,function(t,e){y["default"].includes(c,e)||(p[e]=t,f=!0)}),f&&s.referenceOf&&!r&&this.updateObject(s.referenceOf,p,n),f&&!s.referenceOf&&this.state.objects.filter(function(t){return t.referenceOf===u.id}).forEach(function(t){o.updateObject(t.id,p,n,!0)}),this.setState({objects:[].concat(i(this.state.objects.slice(0,a)),[s],i(this.state.objects.slice(a+1)))}),n||this.postUndo(),this.trigger("object-change",[s]),s}},{key:"getConnectorByPort",value:function(t){return y["default"].find(this.state.connects,function(e){return y["default"].includes(e.ports,t)})}},{key:"updatePort",value:function(t,e,n){var r=this.getObjectByPort(t);if(!r)return console.error("Can not update port "+t+", as object with such port do not exists"),console.log("objects for debug",this.state.objects),null;var o=(0,g.findIndex)(r.ports,function(e){return e.id===t}),a=r.ports[o],u=l({},a,e);return n||this.preUndo(),this.updateObject(r.id,{ports:[].concat(i(r.ports.slice(0,o)),[u],i(r.ports.slice(o+1)))},n),n||this.postUndo(),u}},{key:"selectObject",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=e||this.state.multipleSelectionMode,r=n?this.state.selectedObjects:[],o=t?r.concat(t):r;this.setState({selectedObjects:o})}},{key:"selectConnect",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=e||this.state.multipleSelectionMode,r=n?this.state.selectedConnects:[],o=t?y["default"].unique(r.concat(t)):r;this.setState({selectedConnects:o})}},{key:"selectAll",value:function(){var t=this.state.objects.map(function(t){return t.id}),e=this.state.connects.map(function(t){return t.id});this.setState({selectedConnects:e,selectedObjects:t})}},{key:"deselectAll",value:function(){this.setState({selectedObjects:[],selectedConnects:[]})}},{key:"deselectItem",value:function(t){var e=y["default"].without(this.state.selectedObjects,t),n=y["default"].without(this.state.selectedConnects,t);this.setState({selectedConnects:n,selectedObjects:e})}},{key:"connectPorts",value:function(t,e){var n=this,r=(0,g.find)(this.state.connects,function(n){return(0,g.includes)(n.ports,t)&&(0,g.includes)(n.ports,e)});if(!r){var o=(0,O["default"])(this.state),a=l({},this.state,{connects:[].concat(i(this.state.connects),[{id:(0,g.uniqueId)(),ports:[t,e]}])}),u=(0,O["default"])(a);if(!y["default"].isEqual(u,o))return void console.error("validation error",u);var s=this.getObjectByPort(t),c=this.getObjectByPort(e),p=s.type===c.type,f=(0,g.find)(s.ports,function(e){return e.id===t}),h=(0,g.find)(c.ports,function(t){return t.id===e}),d="input"===f.type?f:"input"===h.type?h:null,v="output"===f.type?f:"output"===h.type?h:null,b=d&&this.getObjectByPort(d.id),m=v&&this.getObjectByPort(v.id);if(this.preUndo(),p&&d&&v){var w="connector"===s.subType?s:"connector"===c.subType?c:null;"gate"===s.type&&"gate"===s.type;if(w===b){this.updateObject(m.id,{outputData:(0,g.cloneDeep)(b.outputData)});var j=this.state.connects.filter(function(t){var e=(0,g.includes)(t.ports,m.ports[0].id)||(0,g.includes)(t.ports,m.ports[1].id);return e});j.forEach(function(t){n.deleteConnect(t.id)})}w===m&&this.updateObject(b.id,{outputData:(0,g.cloneDeep)(m.outputData)})}this.setState({connects:[].concat(i(this.state.connects),[{id:(0,g.uniqueId)(),ports:[t,e]}])}),this.postUndo()}}},{key:"createTempConnect",value:function(t){var e=this.state.viewport;this.setState({tempConnect:{show:!0,startPos:{x:e.x,y:e.y},startPortId:t}})}},{key:"removeTempConnect",value:function(){this.setState({tempConnect:{show:!1}})}},{key:"getObjectIndex",value:function(t){return this.indexCache[t]||(this.indexCache[t]=(0,g.findIndex)(this.state.objects,function(e){return e.id===t})),this.indexCache[t]}},{key:"getPort",value:function(t){var e=this.getObjectByPort(t);return y["default"].find(e.ports,function(e){return e.id===t})}},{key:"getObject",value:function(t){var e=this.getObjectIndex(t);return this.state.objects[e]}},{key:"getObjectByPort",value:function(t){return this.indexCache[t]||(this.indexCache[t]=(0,g.findIndex)(this.state.objects,function(e){return(0,g.find)(e.ports,function(e){return e.id===t})})),this.state.objects[this.indexCache[t]]}},{key:"getConnect",value:function(t){return y["default"].find(this.state.connects,function(e){return e.id===t})}},{key:"getConnectPoints",value:function(t){var e=this.getConnect(t);return y["default"].map(e.ports,this.getPortAbsolutePosition.bind(this))}},{key:"getPortAbsolutePosition",value:function(t){var e=this.getObjectByPort(t),n=this.getObjectAbsolutePosition(e.id),r=this.getPort(t),o=e.width,i=e.height,a=r.position,u=o/2,s=i/2,c=void 0,l=void 0;return a>=0&&a<Math.PI/4||7*Math.PI/4<a&&a<=2*Math.PI?(c=u+o/2,l=s-Math.sin(a)*i/2):a>=Math.PI/4&&a<3*Math.PI/4?(c=u+Math.cos(a)*o/2,l=s-i/2):a>=3*Math.PI/4&&a<5*Math.PI/4?(c=u-o/2,l=s-Math.sin(a)*i/2):a>=5*Math.PI/4&&a<=7*Math.PI/4?(c=u+Math.cos(a)*o/2,l=s+i/2):console.error("Unsupported port position",a),{x:c+n.x,y:l+n.y}}},{key:"addChildObject",value:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];this.preUndo();var r=this.getObject(e),o=this.getObject(r.parent);o&&this.updateObject(o.id,{children:y["default"].without(o.children,e)}),this.updateObject(e,l({},n,{parent:t}));var a=this.getObject(t);this.updateObject(t,{children:(0,g.uniq)([].concat(i(a.children),[e]))}),r=this.getObject(e);var u=20;r.x<0&&(this.resizeObject(t,{x:a.x-Math.abs(r.x)-u,width:a.width+Math.abs(r.x)+u},!0,!0,!0),this.updateObject(e,{x:u}),a=this.getObject(t),r=this.getObject(e)),r.y<0&&(this.resizeObject(t,{y:a.y-Math.abs(r.y)-u,height:a.height+Math.abs(r.y)+u},!0,!0,!0),this.updateObject(e,{y:u}),a=this.getObject(t),r=this.getObject(e)),a.width<r.x+r.width&&(this.resizeObject(t,{width:r.x+r.width+u},!0,!0,!0),a=this.getObject(t)),a.height<r.y+r.height&&this.resizeObject(t,{height:r.y+r.height+u},!0,!0,!0),this.postUndo()}},{key:"removeFromParent",value:function(t){var e=this.getObject(t);if(e&&e.parent){this.preUndo(),this.updateObject(t,{parent:0},!0);var n=this.getObject(e.parent);this.updateObject(e.parent,{children:(0,g.without)(n.children,t)},!0),this.postUndo()}}},{key:"resizeObject",value:function(t,e,n,r,o){var i=e.width,a=e.height,u=e.x,s=e.y,c=this,l=20,p=this.getObject(t);i=i||p.width,a=a||p.height,u=u||p.x,s=s||p.y,0>i&&(u+=i,i=-i),0>a&&(s+=a,a=-a),p.parent&&!function(){var t=c.getObject(p.parent),e=Math.max(t.width,u+i+l),n=Math.max(t.height,s+a+l),r=t.x,o=t.y,f=l-u,h=l-s;f>0&&(r=t.x-f,e+=f,u=l),h>0&&(o=t.y-h,n+=h,s=l),c.resizeObject(t.id,{width:e,height:n,x:r,y:o},!0,!0),t.children.forEach(function(t){if(t!==p.id){var e=c.getObject(t),n=f>0?e.x+f:e.x,r=h>0?e.y+h:e.y;c.updateObject(t,{x:n,y:r})}})}(),o||!function(){var e=u-p.x,n=s-p.y,r=i-p.width,o=a-p.height;y["default"].each(c.state.selectedObjects,function(i){if(i!==t&&!c.isAncesorOf(i,t)&&!c.isAncesorOf(t,i)){var a=c.getObject(i);c.resizeObject(i,{x:a.x+e,y:a.y+n,width:a.width+r,height:a.height+o},!0,!1,!0)}})}();var f=i/p.width,h=a/p.height;n||this.preUndo(),this.updateObject(t,{width:i,height:a,x:u,y:s},n),r||p.children.forEach(function(t){var e=c.getObject(t);c.updateObject(t,{x:e.x*f,y:e.y*h},n),c.resizeObject(t,{width:e.width*f,height:e.height*h},n)}),n||this.postUndo()}},{key:"updateViewport",value:function(t){var e=this.state.viewport;t.x=t.x||e.x,t.y=t.y||e.y,this.setState({viewport:l({},this.state.viewport,t)}),this.ensureViewportAttrs()}},{key:"changeScaleLevel",value:function(t){var e=this.state.viewport,n=e.scale,r=e.x,o=e.y,i=t/n;this.updateViewport({x:r+this.state.width*(i-1)/2/t,y:o+this.state.height*(i-1)/2/t,scale:t})}},{key:"scaleBy",value:function(t){var e=this.state.viewport.scale;this.changeScaleLevel(e*t)}},{key:"checkAutoScroll",value:function(t){var e=50,n=this.state.autoScrollOffset;t.y<e&&(this.updateViewport({y:this.state.viewport.y-n}),this.hideTooltip()),t.x<e&&(this.updateViewport({x:this.state.viewport.x-n}),this.hideTooltip()),t.x>this.state.width-e&&(this.updateViewport({x:this.state.viewport.x+n}),this.hideTooltip()),t.y>this.state.height-e&&(this.updateViewport({y:this.state.viewport.y+n}),this.hideTooltip())}},{key:"ensureViewportAttrs",value:function(){var t=this.state.objects[0],e=t&&t.x||0,n=e,r=t&&t.y||0,o=r;this.state.objects.forEach(function(t){t.parent||(e=Math.min(e,t.x),r=Math.min(r,t.y),n=Math.max(n,t.x+t.width),o=Math.max(o,t.y+t.height))});var i=this.state.viewport;e=Math.min(e,i.x),r=Math.min(r,i.y),n=Math.max(n,i.x+this.state.width/i.scale),o=Math.max(o,i.y+this.state.height/i.scale);this.state.viewport.scale;this.setState({viewport:l({},this.state.viewport,{minX:e,maxX:n,minY:r,maxY:o})})}},{key:"createSelector",value:function(t){var e=this.state.viewport;this.setState({selector:{show:!0,x:e.x+t.x/e.scale,y:e.y+t.y/e.scale}})}},{key:"createPanDragger",value:function(t){this.setState({panDragger:{show:!0,x:t.x,y:t.y}})}},{key:"deletePanDragger",value:function(){this.setState({panDragger:{show:!1}})}},{key:"selectObjectsInArea",value:function(t){var e=this;t.width<0&&(t.x=t.x+t.width,t.width=-t.width),t.height<0&&(t.y=t.y+t.height,t.height=-t.height);var n=this.state.objects.filter(function(e){return j.isInside(t,e)}).map(function(t){return t.id}),r=this.state.connects.filter(function(n){var r=e.getConnectPoints(n.id);return j.isRectIntersectLine(t,r)}).map(function(t){return t.id});this.setState({selectedObjects:n,selectedConnects:r,selector:{show:!1}})}},{key:"createChipWithSelectedObjects",value:function(t){var e=this;if(0===this.state.selectedObjects.length)return console.error("No selected objects to create chip."),null;var n=this.state.selectedObjects.map(this.getObject.bind(this)),r=1===y["default"].uniq(n.map(function(t){return t.parent})).length;if(!r)return void console.error("all objects must be in same parent");var o=30;if(0===n.length)return console.error("can not create chip for children objects"),null;var a=Math.min.apply(null,n.map(function(t){return t.x})),u=Math.min.apply(null,n.map(function(t){return t.y})),c=Math.max.apply(null,n.map(function(t){return t.x+t.width})),p=Math.max.apply(null,n.map(function(t){return t.y+t.height})),f=l({},s(),{type:"chip",name:t,x:a-o,y:u-o,width:c+2*o-a,height:p+2*o-u});this.setState({showCreateChipPrompt:!1}),this.preUndo(),this.setState({showCreateChipPrompt:!1,objects:[f].concat(i(this.state.objects))});var h=n[0].parent;return n.forEach(function(t){e.updateObject(t.id,l({},t,{x:t.x-f.x,y:t.y-f.y})),e.addChildObject(f.id,t.id)}),h&&this.addChildObject(h,f.id),this.postUndo(),this.indexCache={},this.trigger("object-create",[f]),f}},{key:"hidePrompt",value:function(){this.setState({showCreateChipPrompt:!1})}},{key:"drillDown",value:function(t){this.updateObject(t,{showChildren:!0})}},{key:"drillUp",value:function(t){this.updateObject(t,{showChildren:!1})}},{key:"createBookmark",value:function(t){var e=this.getObject(t);this.trigger("object-bookmark-click",[e])}},{key:"fitViewport",value:function(t){var e=this.getObject(t),n=void 0,r=void 0,o=void 0,i=this.state,a=i.width,u=i.height;if(e){o=Math.min((a-100)/e.width,(u-100)/e.height);var s=this.getObjectAbsolutePosition(e.id);n=s.x+e.width/2,r=s.y+e.height/2}else{var c=this.getConnect(t);if(!c)return void console.error("no object with id "+t);var p=this.getObjectByPort(c.ports[0]),f=this.getObjectAbsolutePosition(p.id),h=this.getObjectByPort(c.ports[1]),d=this.getObjectAbsolutePosition(h.id);n=(f.x+d.x)/2,r=(f.y+d.y)/2;var v=Math.abs(f.x-d.x),g=Math.abs(f.y-d.y);o=Math.min((a-100)/v,(u-100)/g)}var y=l({},this.state.viewport,{x:n-a/2/o,y:r-u/2/o,scale:o}),b=Math.abs(y.x-this.state.viewport.x),m=Math.abs(y.y-this.state.viewport.y),w=Math.abs(y.scale-this.state.viewport.scale),j=.2>w&&20>b+m&&this.previousViewport;j?this.setState({viewport:this.previousViewport}):(this.previousViewport=this.state.viewport,this.updateViewport(y))}},{key:"deleteSelected",value:function(){var t=this,e=this.state.objects.filter(function(e){return(0,g.includes)(t.state.selectedObjects,e.id)});this.preUndo(),e.forEach(function(e){t.deleteObject(e.id)});var n=this.state.connects.filter(function(e){return(0,g.includes)(t.state.selectedConnects,e.id)});n.forEach(function(e){t.deleteConnect(e.id)}),this.setState({selectedObjects:[],selectedConnects:[]}),this.ensureViewportAttrs(),this.postUndo()}},{key:"deleteObject",value:function(t){var e=this;this.removeFromParent(t);var n=this.getObject(t);if(n){this.indexCache={},n.children.forEach(function(t){e.deleteObject(t)}),n.ports.forEach(function(t){var n=(0,g.find)(e.state.connects,function(e){return e.ports[0]===t.id||e.ports[1]===t.id});n&&e.deleteConnect(n.id)});var r=(0,g.findIndex)(this.state.objects,function(e){return e.id===t});this.setState({objects:[].concat(i(this.state.objects.slice(0,r)),i(this.state.objects.slice(r+1)))}),this.indexCache={},n.name===this.state.tooltip.text&&this.hideTooltip(),this.trigger("object-delete",[n])}}},{key:"deleteConnect",value:function(t){var e=(0,g.findIndex)(this.state.connects,function(e){return e.id===t});this.preUndo(),this.setState({connects:[].concat(i(this.state.connects.slice(0,e)),i(this.state.connects.slice(e+1)))}),this.postUndo()}},{key:"requestCreateChip",value:function(){this.setState({showCreateChipPrompt:this.state.selectedObjects.length>0})}},{key:"showAdvancedProperties",value:function(t){this.setState({advancedProperties:{show:!0,object:t}})}},{key:"hideAdvancedProperties",value:function(){this.setState({advancedProperties:{show:!1}})}},{key:"showTooltip",value:function(t){clearTimeout(this.tooltipTimeout),this.setState({tooltip:l({},this.state.tooltip,{show:!0},t)})}},{key:"hideTooltip",value:function(){var t=this;this.tooltipTimeout=setTimeout(function(){t.setState({tooltip:l({},t.state.tooltip,{show:!1})})},this.state.tooltipDelay)}},{key:"search",value:function(t){if(!t)return void this.setState({searchMatchedObjects:[]});t=t.toLowerCase();var e=[];this.state.objects.forEach(function(n){var r=(n.type+n.name).toLowerCase();y["default"].includes(r,t)&&e.push(n.id)}),this.setState({searchMatchedObjects:e})}},{key:"shouldHighligh",value:function(t){var e=this;if(y["default"].includes(this.state.searchMatchedObjects,t))return!0;var n=this.getObject(t),r=y["default"].any(n.children,function(t){return e.shouldHighligh(t)});return r&&!n.showChildren}},{key:"getConnectorPoints",value:function(t){this.getConnector()}},{key:"getObjectAbsolutePosition",value:function(t,e){var n=this.getObject(t);if(e||(e={x:n.x,y:n.y}),!n.parent)return{x:e.x,y:e.y,zindex:0};var r=this.getObjectAbsolutePosition(n.parent);return{x:r.x+e.x,y:r.y+e.y,zindex:r.zindex+1}}},{key:"isObjectVisible",value:function(t){var e=this.getObject(t);if(!e.parent)return!0;var n=this.getObject(e.parent);return n.showChildren&&this.isObjectVisible(n.id)}},{key:"isObjectOnScreen",value:function(t){var e=this.getObject(t),n=this.getObjectAbsolutePosition(t),r=this.state.viewport,o=this.state,i=o.width,a=o.height;return e.isDragging?!0:n.x>r.x+i/r.scale?!1:n.y>r.y+a/r.scale?!1:n.x+e.width<r.x?!1:n.y+e.height<r.y?!1:!0}},{key:"isAncesorOf",value:function(t,e){var n=this.getObject(t);if(!n.parent)return!1;var r=this.getObject(e);return n.parent===r.id?!0:this.isAncesorOf(n.parent,e)}},{key:"isOverlap",value:function(t,e){var n=this,r=this.getObject(t),o=this.getObjectAbsolutePosition(t),i=this.getObjectAbsolutePosition(t,e),a=y["default"].find(this.state.objects,function(e){if(e.id===t)return!1;if("gate"!==e.type)return!1;var a=n.getObjectAbsolutePosition(e.id),u=j.isOverlap(l({},e,a),l({},r,o)),s=j.isOverlap(l({},e,a),l({},r,i));return!u&&s});return a}},{key:"onObjectDragMove",value:function(t,e){var n=this,r=this.getObject(t),o=r.x-e.x,i=r.y-e.y;this.updateObject(t,e,!0);var a=(0,g.find)(this.state.objects,function(t){return t.dropTarget});a&&this.updateObject(a.id,{dropTarget:!1},!0);var u=this.getDropTarget(t);u&&this.updateObject(u.id,{dropTarget:!0},!0),y["default"].each(this.state.selectedObjects,function(e){if(e!==t&&!n.isAncesorOf(t,e)&&!n.isAncesorOf(e,t)){var r=n.getObject(e);n.updateObject(e,{x:r.x-o,y:r.y-i})}})}},{key:"getDropTarget",value:function(t){var e=this,n=this.getObject(t),r=this.getObjectAbsolutePosition(t),o=void 0,i=0;return y["default"].each(this.state.objects,function(a){var u=a.id===t;if(!u){var s="gate"===a.type;if(!s){var c=e.getObjectAbsolutePosition(a.id),p=j.isInside(l({},a,c),l({},n,r)),f=e.isAncesorOf(a.id,t),h=p&&!f&&a.showChildren,d=!o||i<c.zindex;h&&d&&(o=a,i=c.zindex)}}}),o}},{key:"onObjectDragEnd",value:function(t,e){var n=(0,g.find)(this.state.objects,function(t){return t.dropTarget}),r=this.getObject(t),o=this.getObjectAbsolutePosition(t);if(this.preUndo(),this.updateObject(t,l({},e,{isDragging:!1})),n){var i=this.getObjectAbsolutePosition(n.id);this.addChildObject(n.id,t,{x:o.x-i.x,y:o.y-i.y}),this.updateObject(n.id,{dropTarget:!1})}else r.parent&&(this.removeFromParent(t),this.updateObject(t,o));this.postUndo(),this.ensureViewportAttrs()}},{key:"onObjectDragStart",value:function(t){y["default"].includes(this.state.selectedObjects,t)||this.selectObject(t);var e=this.getObject(t),n=l({},e,{isDragging:!0}),r=this.getObjectIndex(t);this.setState({objects:[].concat(i(this.state.objects.slice(0,r)),i(this.state.objects.slice(r+1)),[n])}),this.indexCache={}}},{key:"preUndo",value:function(){this.recordCount+=1}},{key:"postUndo",value:function(){this.recordCount-=1,0===this.recordCount&&(this.historyStep<this.history.length-1&&(this.history=this.history.slice(0,this.historyStep+1)),this.history.push(this.getCleanState()),this.historyStep+=1)}},{key:"undo",value:function(){return 0===this.historyStep?void console.log("no undo action"):(this.historyStep-=1,this.indexCache={},void this.setState(this.history[this.historyStep]))}},{key:"redo",value:function(){return this.historyStep===this.history.length-1?void console.log("no redo action"):(this.historyStep+=1,this.indexCache={},void this.setState(this.history[this.historyStep]));
}},{key:"togglePanMode",value:function(){this.setState({panMode:!this.state.panMode})}},{key:"toggleMultipleSelectionMode",value:function(){this.setState({multipleSelectionMode:!this.state.multipleSelectionMode})}},{key:"createReference",value:function(t){var e=this.getObject(t),n=e.referenceOf||t;if("connector"!==e.subType.toLowerCase())return console.error("can create reference to connector only"),null;this.preUndo();var r=this.createObject({type:"gate",subType:"connector",name:e.name,x:e.x+200,y:e.y+50,referenceOf:n,outputData:y["default"].cloneDeep(e.outputData),rules:y["default"].cloneDeep(e.rules),customAttributes:y["default"].cloneDeep(e.customAttributes),additionalPanels:y["default"].cloneDeep(e.additionalPanels)});return this.postUndo(),r}},{key:"isGateSource",value:function(t){var e=this.getObject(t);return"connector"===e.subType}},{key:"getObjectInputs",value:function(t,e){var n=this,r=this.getObject(t);if(!e){var o=function(){var e=y["default"].filter(r.ports,function(t){return"input"===t.type}),o=[];return e.forEach(function(e){o=o.concat(n.getObjectInputs(t,e.id))}),{v:o}}();if("object"===("undefined"==typeof o?"undefined":c(o)))return o.v}if(this.isGateSource(t))return r.outputData.map(function(t){return l({},t,{object:r})});for(var i=y["default"].find(r.ports,function(t){return t.id===e}),a=void 0,u=void 0;;){var s=y["default"].find(this.state.connects,function(t){var e=y["default"].includes(t.ports,i.id);if(!e)return!1;var r=t.ports[0]===i.id?t.ports[1]:t.ports[0],o=n.getObjectByPort(i.id),a=n.getObjectByPort(r),u=a.parent===o.id;return u?!1:!0});if(!s)return[];if(u=s.ports[0]===i.id?s.ports[1]:s.ports[0],a=this.getPort(u),"input"!==a.type)break;i=a}var p=this.getObjectByPort(u);if("gate"===p.type)return p.outputData.map(function(t){return l({},t,{object:p})});for(var f=a.id,h=function(){var t=void 0;return y["default"].find(n.state.connects,function(e){var r=y["default"].includes(e.ports,f);if(!r)return!1;var o=e.ports[0]===f?e.ports[1]:e.ports[0],i=n.getObjectByPort(o),a=i.parent===p.id;return a?(t=i,f=o,!0):!1}),t&&"chip"===t.type?(p=t,"continue"):t&&(t.type="gate")?{v:t.outputData.map(function(e){return l({},e,{object:t})})}:{v:[]}};"chip"===p.type;){var d=h();switch(d){case"continue":continue;default:if("object"===("undefined"==typeof d?"undefined":c(d)))return d.v}}return p.outputData.map(function(t){return l({},t,{object:p})})}},{key:"setElementsMapping",value:function(t,e){return this.updateObject(t,{outputData:e})}},{key:"getStateErrors",value:function(){return(0,O["default"])(this.state)}}],[{key:"getObjectDefaults",value:function(){return s()}}]),t}();e["default"]=_},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=window.React;e["default"]=n},function(t,e){"use strict";var n=window.ReactDOM;t.exports=n},function(t,e,n){var r;(function(t,o){(function(){function i(t,e){if(t!==e){var n=null===t,r=t===P,o=t===t,i=null===e,a=e===P,u=e===e;if(t>e&&!i||!o||n&&!a&&u||r&&u)return 1;if(e>t&&!n||!u||i&&!r&&o||a&&o)return-1}return 0}function a(t,e,n){for(var r=t.length,o=n?r:-1;n?o--:++o<r;)if(e(t[o],o,t))return o;return-1}function u(t,e,n){if(e!==e)return b(t,n);for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}function s(t){return"function"==typeof t||!1}function c(t){return null==t?"":t+""}function l(t,e){for(var n=-1,r=t.length;++n<r&&e.indexOf(t.charAt(n))>-1;);return n}function p(t,e){for(var n=t.length;n--&&e.indexOf(t.charAt(n))>-1;);return n}function f(t,e){return i(t.criteria,e.criteria)||t.index-e.index}function h(t,e,n){for(var r=-1,o=t.criteria,a=e.criteria,u=o.length,s=n.length;++r<u;){var c=i(o[r],a[r]);if(c){if(r>=s)return c;var l=n[r];return c*("asc"===l||l===!0?1:-1)}}return t.index-e.index}function d(t){return Wt[t]}function v(t){return Yt[t]}function g(t,e,n){return e?t=Ht[t]:n&&(t=Jt[t]),"\\"+t}function y(t){return"\\"+Jt[t]}function b(t,e,n){for(var r=t.length,o=e+(n?0:-1);n?o--:++o<r;){var i=t[o];if(i!==i)return o}return-1}function m(t){return!!t&&"object"==typeof t}function w(t){return 160>=t&&t>=9&&13>=t||32==t||160==t||5760==t||6158==t||t>=8192&&(8202>=t||8232==t||8233==t||8239==t||8287==t||12288==t||65279==t)}function j(t,e){for(var n=-1,r=t.length,o=-1,i=[];++n<r;)t[n]===e&&(t[n]=W,i[++o]=n);return i}function x(t,e){for(var n,r=-1,o=t.length,i=-1,a=[];++r<o;){var u=t[r],s=e?e(u,r,t):u;r&&n===s||(n=s,a[++i]=u)}return a}function O(t){for(var e=-1,n=t.length;++e<n&&w(t.charCodeAt(e)););return e}function _(t){for(var e=t.length;e--&&w(t.charCodeAt(e)););return e}function k(t){return Xt[t]}function E(t){function e(t){if(m(t)&&!Cu(t)&&!(t instanceof o)){if(t instanceof r)return t;if(ea.call(t,"__chain__")&&ea.call(t,"__wrapped__"))return hr(t)}return new r(t)}function n(){}function r(t,e,n){this.__wrapped__=t,this.__actions__=n||[],this.__chain__=!!e}function o(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ma,this.__views__=[]}function w(){var t=new o(this.__wrapped__);return t.__actions__=te(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=te(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=te(this.__views__),t}function Q(){if(this.__filtered__){var t=new o(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function rt(){var t=this.__wrapped__.value(),e=this.__dir__,n=Cu(t),r=0>e,o=n?t.length:0,i=Wn(0,o,this.__views__),a=i.start,u=i.end,s=u-a,c=r?u:a-1,l=this.__iteratees__,p=l.length,f=0,h=Oa(s,this.__takeCount__);if(!n||$>o||o==s&&h==s)return nn(r&&n?t.reverse():t,this.__actions__);var d=[];t:for(;s--&&h>f;){c+=e;for(var v=-1,g=t[c];++v<p;){var y=l[v],b=y.iteratee,m=y.type,w=b(g);if(m==G)g=w;else if(!w){if(m==V)continue t;break t}}d[f++]=g}return d}function it(){this.__data__={}}function Wt(t){return this.has(t)&&delete this.__data__[t]}function Yt(t){return"__proto__"==t?P:this.__data__[t]}function Xt(t){return"__proto__"!=t&&ea.call(this.__data__,t)}function Kt(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this}function Ht(t){var e=t?t.length:0;for(this.data={hash:ya(null),set:new pa};e--;)this.push(t[e])}function Jt(t,e){var n=t.data,r="string"==typeof e||Ro(e)?n.set.has(e):n.hash[e];return r?0:-1}function Zt(t){var e=this.data;"string"==typeof t||Ro(t)?e.set.add(t):e.hash[t]=!0}function Qt(t,e){for(var n=-1,r=t.length,o=-1,i=e.length,a=Bi(r+i);++n<r;)a[n]=t[n];for(;++o<i;)a[n++]=e[o];return a}function te(t,e){var n=-1,r=t.length;for(e||(e=Bi(r));++n<r;)e[n]=t[n];return e}function ee(t,e){for(var n=-1,r=t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function ne(t,e){for(var n=t.length;n--&&e(t[n],n,t)!==!1;);return t}function ie(t,e){for(var n=-1,r=t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function ae(t,e,n,r){for(var o=-1,i=t.length,a=r,u=a;++o<i;){var s=t[o],c=+e(s);n(c,a)&&(a=c,u=s)}return u}function ue(t,e){for(var n=-1,r=t.length,o=-1,i=[];++n<r;){var a=t[n];e(a,n,t)&&(i[++o]=a)}return i}function se(t,e){for(var n=-1,r=t.length,o=Bi(r);++n<r;)o[n]=e(t[n],n,t);return o}function ce(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}function le(t,e,n,r){var o=-1,i=t.length;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}function pe(t,e,n,r){var o=t.length;for(r&&o&&(n=t[--o]);o--;)n=e(n,t[o],o,t);return n}function fe(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function he(t,e){for(var n=t.length,r=0;n--;)r+=+e(t[n])||0;return r}function de(t,e){return t===P?e:t}function ve(t,e,n,r){return t!==P&&ea.call(r,n)?t:e}function ge(t,e,n){for(var r=-1,o=Nu(e),i=o.length;++r<i;){var a=o[r],u=t[a],s=n(u,e[a],a,t,e);(s===s?s===u:u!==u)&&(u!==P||a in t)||(t[a]=s)}return t}function ye(t,e){return null==e?t:me(e,Nu(e),t)}function be(t,e){for(var n=-1,r=null==t,o=!r&&Jn(t),i=o?t.length:0,a=e.length,u=Bi(a);++n<a;){var s=e[n];o?u[n]=Zn(s,i)?t[s]:P:u[n]=r?P:t[s]}return u}function me(t,e,n){n||(n={});for(var r=-1,o=e.length;++r<o;){var i=e[r];n[i]=t[i]}return n}function we(t,e,n){var r=typeof t;return"function"==r?e===P?t:an(t,e,n):null==t?Mi:"object"==r?qe(t):e===P?Ai(t):Ne(t,e)}function je(t,e,n,r,o,i,a){var u;if(n&&(u=o?n(t,r,o):n(t)),u!==P)return u;if(!Ro(t))return t;var s=Cu(t);if(s){if(u=Yn(t),!e)return te(t,u)}else{var c=ra.call(t),l=c==Z;if(c!=et&&c!=Y&&(!l||o))return Ft[c]?Kn(t,c,e):o?t:{};if(u=Xn(l?{}:t),!e)return ye(u,t)}i||(i=[]),a||(a=[]);for(var p=i.length;p--;)if(i[p]==t)return a[p];return i.push(t),a.push(u),(s?ee:Se)(t,function(r,o){u[o]=je(r,e,n,o,t,i,a)}),u}function xe(t,e,n){if("function"!=typeof t)throw new Hi(F);return fa(function(){t.apply(P,n)},e)}function Oe(t,e){var n=t?t.length:0,r=[];if(!n)return r;var o=-1,i=Vn(),a=i==u,s=a&&e.length>=$?vn(e):null,c=e.length;s&&(i=Jt,a=!1,e=s);t:for(;++o<n;){var l=t[o];if(a&&l===l){for(var p=c;p--;)if(e[p]===l)continue t;r.push(l)}else i(e,l,0)<0&&r.push(l)}return r}function _e(t,e){var n=!0;return Ua(t,function(t,r,o){return n=!!e(t,r,o)}),n}function ke(t,e,n,r){var o=r,i=o;return Ua(t,function(t,a,u){var s=+e(t,a,u);(n(s,o)||s===r&&s===i)&&(o=s,i=t)}),i}function Ee(t,e,n,r){var o=t.length;for(n=null==n?0:+n||0,0>n&&(n=-n>o?0:o+n),r=r===P||r>o?o:+r||0,0>r&&(r+=o),o=n>r?0:r>>>0,n>>>=0;o>n;)t[n++]=e;return t}function Pe(t,e){var n=[];return Ua(t,function(t,r,o){e(t,r,o)&&n.push(t)}),n}function Me(t,e,n,r){var o;return n(t,function(t,n,i){return e(t,n,i)?(o=r?n:t,!1):void 0}),o}function Ce(t,e,n,r){r||(r=[]);for(var o=-1,i=t.length;++o<i;){var a=t[o];m(a)&&Jn(a)&&(n||Cu(a)||Eo(a))?e?Ce(a,e,n,r):ce(r,a):n||(r[r.length]=a)}return r}function Ie(t,e){return La(t,e,ei)}function Se(t,e){return La(t,e,Nu)}function Te(t,e){return qa(t,e,Nu)}function De(t,e){for(var n=-1,r=e.length,o=-1,i=[];++n<r;){var a=e[n];Ao(t[a])&&(i[++o]=a)}return i}function Ae(t,e,n){if(null!=t){n!==P&&n in pr(t)&&(e=[n]);for(var r=0,o=e.length;null!=t&&o>r;)t=t[e[r++]];return r&&r==o?t:P}}function Re(t,e,n,r,o,i){return t===e?!0:null==t||null==e||!Ro(t)&&!m(e)?t!==t&&e!==e:Ue(t,e,Re,n,r,o,i)}function Ue(t,e,n,r,o,i,a){var u=Cu(t),s=Cu(e),c=X,l=X;u||(c=ra.call(t),c==Y?c=et:c!=et&&(u=Go(t))),s||(l=ra.call(e),l==Y?l=et:l!=et&&(s=Go(e)));var p=c==et,f=l==et,h=c==l;if(h&&!u&&!p)return qn(t,e,c);if(!o){var d=p&&ea.call(t,"__wrapped__"),v=f&&ea.call(e,"__wrapped__");if(d||v)return n(d?t.value():t,v?e.value():e,r,o,i,a)}if(!h)return!1;i||(i=[]),a||(a=[]);for(var g=i.length;g--;)if(i[g]==t)return a[g]==e;i.push(t),a.push(e);var y=(u?Ln:Nn)(t,e,n,r,o,i,a);return i.pop(),a.pop(),y}function ze(t,e,n){var r=e.length,o=r,i=!n;if(null==t)return!o;for(t=pr(t);r--;){var a=e[r];if(i&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<o;){a=e[r];var u=a[0],s=t[u],c=a[1];if(i&&a[2]){if(s===P&&!(u in t))return!1}else{var l=n?n(s,c,u):P;if(!(l===P?Re(c,s,n,!0):l))return!1}}return!0}function Le(t,e){var n=-1,r=Jn(t)?Bi(t.length):[];return Ua(t,function(t,o,i){r[++n]=e(t,o,i)}),r}function qe(t){var e=Gn(t);if(1==e.length&&e[0][2]){var n=e[0][0],r=e[0][1];return function(t){return null==t?!1:t[n]===r&&(r!==P||n in pr(t))}}return function(t){return ze(t,e)}}function Ne(t,e){var n=Cu(t),r=tr(t)&&rr(e),o=t+"";return t=fr(t),function(i){if(null==i)return!1;var a=o;if(i=pr(i),(n||!r)&&!(a in i)){if(i=1==t.length?i:Ae(i,Xe(t,0,-1)),null==i)return!1;a=Er(t),i=pr(i)}return i[a]===e?e!==P||a in i:Re(e,i[a],P,!0)}}function Be(t,e,n,r,o){if(!Ro(t))return t;var i=Jn(e)&&(Cu(e)||Go(e)),a=i?P:Nu(e);return ee(a||e,function(u,s){if(a&&(s=u,u=e[s]),m(u))r||(r=[]),o||(o=[]),$e(t,e,s,Be,n,r,o);else{var c=t[s],l=n?n(c,u,s,t,e):P,p=l===P;p&&(l=u),l===P&&(!i||s in t)||!p&&(l===l?l===c:c!==c)||(t[s]=l)}}),t}function $e(t,e,n,r,o,i,a){for(var u=i.length,s=e[n];u--;)if(i[u]==s)return void(t[n]=a[u]);var c=t[n],l=o?o(c,s,n,t,e):P,p=l===P;p&&(l=s,Jn(s)&&(Cu(s)||Go(s))?l=Cu(c)?c:Jn(c)?te(c):[]:Bo(s)||Eo(s)?l=Eo(c)?Ko(c):Bo(c)?c:{}:p=!1),i.push(s),a.push(l),p?t[n]=r(l,s,o,i,a):(l===l?l!==c:c===c)&&(t[n]=l)}function Ve(t){return function(e){return null==e?P:e[t]}}function Ge(t){var e=t+"";return t=fr(t),function(n){return Ae(n,t,e)}}function Fe(t,e){for(var n=t?e.length:0;n--;){var r=e[n];if(r!=o&&Zn(r)){var o=r;ha.call(t,r,1)}}return t}function We(t,e){return t+ba(Ea()*(e-t+1))}function Ye(t,e,n,r,o){return o(t,function(t,o,i){n=r?(r=!1,t):e(n,t,o,i)}),n}function Xe(t,e,n){var r=-1,o=t.length;e=null==e?0:+e||0,0>e&&(e=-e>o?0:o+e),n=n===P||n>o?o:+n||0,0>n&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Bi(o);++r<o;)i[r]=t[r+e];return i}function Ke(t,e){var n;return Ua(t,function(t,r,o){return n=e(t,r,o),!n}),!!n}function He(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function Je(t,e,n){var r=Bn(),o=-1;e=se(e,function(t){return r(t)});var i=Le(t,function(t){var n=se(e,function(e){return e(t)});return{criteria:n,index:++o,value:t}});return He(i,function(t,e){return h(t,e,n)})}function Ze(t,e){var n=0;return Ua(t,function(t,r,o){n+=+e(t,r,o)||0}),n}function Qe(t,e){var n=-1,r=Vn(),o=t.length,i=r==u,a=i&&o>=$,s=a?vn():null,c=[];s?(r=Jt,i=!1):(a=!1,s=e?[]:c);t:for(;++n<o;){var l=t[n],p=e?e(l,n,t):l;if(i&&l===l){for(var f=s.length;f--;)if(s[f]===p)continue t;e&&s.push(p),c.push(l)}else r(s,p,0)<0&&((e||a)&&s.push(p),c.push(l))}return c}function tn(t,e){for(var n=-1,r=e.length,o=Bi(r);++n<r;)o[n]=t[e[n]];return o}function en(t,e,n,r){for(var o=t.length,i=r?o:-1;(r?i--:++i<o)&&e(t[i],i,t););return n?Xe(t,r?0:i,r?i+1:o):Xe(t,r?i+1:0,r?o:i)}function nn(t,e){var n=t;n instanceof o&&(n=n.value());for(var r=-1,i=e.length;++r<i;){var a=e[r];n=a.func.apply(a.thisArg,ce([n],a.args))}return n}function rn(t,e,n){var r=0,o=t?t.length:r;if("number"==typeof e&&e===e&&Sa>=o){for(;o>r;){var i=r+o>>>1,a=t[i];(n?e>=a:e>a)&&null!==a?r=i+1:o=i}return o}return on(t,e,Mi,n)}function on(t,e,n,r){e=n(e);for(var o=0,i=t?t.length:0,a=e!==e,u=null===e,s=e===P;i>o;){var c=ba((o+i)/2),l=n(t[c]),p=l!==P,f=l===l;if(a)var h=f||r;else h=u?f&&p&&(r||null!=l):s?f&&(r||p):null==l?!1:r?e>=l:e>l;h?o=c+1:i=c}return Oa(i,Ia)}function an(t,e,n){if("function"!=typeof t)return Mi;if(e===P)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){return t.call(e,n,r,o,i)};case 5:return function(n,r,o,i,a){return t.call(e,n,r,o,i,a)}}return function(){return t.apply(e,arguments)}}function un(t){var e=new aa(t.byteLength),n=new da(e);return n.set(new da(t)),e}function sn(t,e,n){for(var r=n.length,o=-1,i=xa(t.length-r,0),a=-1,u=e.length,s=Bi(u+i);++a<u;)s[a]=e[a];for(;++o<r;)s[n[o]]=t[o];for(;i--;)s[a++]=t[o++];return s}function cn(t,e,n){for(var r=-1,o=n.length,i=-1,a=xa(t.length-o,0),u=-1,s=e.length,c=Bi(a+s);++i<a;)c[i]=t[i];for(var l=i;++u<s;)c[l+u]=e[u];for(;++r<o;)c[l+n[r]]=t[i++];return c}function ln(t,e){return function(n,r,o){var i=e?e():{};if(r=Bn(r,o,3),Cu(n))for(var a=-1,u=n.length;++a<u;){var s=n[a];t(i,s,r(s,a,n),n)}else Ua(n,function(e,n,o){t(i,e,r(e,n,o),o)});return i}}function pn(t){return bo(function(e,n){var r=-1,o=null==e?0:n.length,i=o>2?n[o-2]:P,a=o>2?n[2]:P,u=o>1?n[o-1]:P;for("function"==typeof i?(i=an(i,u,5),o-=2):(i="function"==typeof u?u:P,o-=i?1:0),a&&Qn(n[0],n[1],a)&&(i=3>o?P:i,o=1);++r<o;){var s=n[r];s&&t(e,s,i)}return e})}function fn(t,e){return function(n,r){var o=n?$a(n):0;if(!nr(o))return t(n,r);for(var i=e?o:-1,a=pr(n);(e?i--:++i<o)&&r(a[i],i,a)!==!1;);return n}}function hn(t){return function(e,n,r){for(var o=pr(e),i=r(e),a=i.length,u=t?a:-1;t?u--:++u<a;){var s=i[u];if(n(o[s],s,o)===!1)break}return e}}function dn(t,e){function n(){var o=this&&this!==re&&this instanceof n?r:t;return o.apply(e,arguments)}var r=yn(t);return n}function vn(t){return ya&&pa?new Ht(t):null}function gn(t){return function(e){for(var n=-1,r=ki(pi(e)),o=r.length,i="";++n<o;)i=t(i,r[n],n);return i}}function yn(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Ra(t.prototype),r=t.apply(n,e);return Ro(r)?r:n}}function bn(t){function e(n,r,o){o&&Qn(n,r,o)&&(r=P);var i=zn(n,t,P,P,P,P,P,r);return i.placeholder=e.placeholder,i}return e}function mn(t,e){return bo(function(n){var r=n[0];return null==r?r:(n.push(e),t.apply(P,n))})}function wn(t,e){return function(n,r,o){if(o&&Qn(n,r,o)&&(r=P),r=Bn(r,o,3),1==r.length){n=Cu(n)?n:lr(n);var i=ae(n,r,t,e);if(!n.length||i!==e)return i}return ke(n,r,t,e)}}function jn(t,e){return function(n,r,o){if(r=Bn(r,o,3),Cu(n)){var i=a(n,r,e);return i>-1?n[i]:P}return Me(n,r,t)}}function xn(t){return function(e,n,r){return e&&e.length?(n=Bn(n,r,3),a(e,n,t)):-1}}function On(t){return function(e,n,r){return n=Bn(n,r,3),Me(e,n,t,!0)}}function _n(t){return function(){for(var e,n=arguments.length,o=t?n:-1,i=0,a=Bi(n);t?o--:++o<n;){var u=a[i++]=arguments[o];if("function"!=typeof u)throw new Hi(F);!e&&r.prototype.thru&&"wrapper"==$n(u)&&(e=new r([],!0))}for(o=e?-1:n;++o<n;){u=a[o];var s=$n(u),c="wrapper"==s?Ba(u):P;e=c&&er(c[0])&&c[1]==(U|T|A|z)&&!c[4].length&&1==c[9]?e[$n(c[0])].apply(e,c[3]):1==u.length&&er(u)?e[s]():e.thru(u)}return function(){var t=arguments,r=t[0];if(e&&1==t.length&&Cu(r)&&r.length>=$)return e.plant(r).value();for(var o=0,i=n?a[o].apply(this,t):r;++o<n;)i=a[o].call(this,i);return i}}}function kn(t,e){return function(n,r,o){return"function"==typeof r&&o===P&&Cu(n)?t(n,r):e(n,an(r,o,3))}}function En(t){return function(e,n,r){return("function"!=typeof n||r!==P)&&(n=an(n,r,3)),t(e,n,ei)}}function Pn(t){return function(e,n,r){return("function"!=typeof n||r!==P)&&(n=an(n,r,3)),t(e,n)}}function Mn(t){return function(e,n,r){var o={};return n=Bn(n,r,3),Se(e,function(e,r,i){var a=n(e,r,i);r=t?a:r,e=t?e:a,o[r]=e}),o}}function Cn(t){return function(e,n,r){return e=c(e),(t?e:"")+Dn(e,n,r)+(t?"":e)}}function In(t){var e=bo(function(n,r){var o=j(r,e.placeholder);return zn(n,t,P,r,o)});return e}function Sn(t,e){return function(n,r,o,i){var a=arguments.length<3;return"function"==typeof r&&i===P&&Cu(n)?t(n,r,o,a):Ye(n,Bn(r,i,4),o,a,e)}}function Tn(t,e,n,r,o,i,a,u,s,c){function l(){for(var b=arguments.length,m=b,w=Bi(b);m--;)w[m]=arguments[m];if(r&&(w=sn(w,r,o)),i&&(w=cn(w,i,a)),d||g){var x=l.placeholder,O=j(w,x);if(b-=O.length,c>b){var _=u?te(u):P,k=xa(c-b,0),E=d?O:P,M=d?P:O,S=d?w:P,T=d?P:w;e|=d?A:R,e&=~(d?R:A),v||(e&=~(C|I));var D=[t,e,n,S,E,T,M,_,s,k],U=Tn.apply(P,D);return er(t)&&Va(U,D),U.placeholder=x,U}}var z=f?n:this,L=h?z[t]:t;return u&&(w=sr(w,u)),p&&s<w.length&&(w.length=s),this&&this!==re&&this instanceof l&&(L=y||yn(t)),L.apply(z,w)}var p=e&U,f=e&C,h=e&I,d=e&T,v=e&S,g=e&D,y=h?P:yn(t);return l}function Dn(t,e,n){var r=t.length;if(e=+e,r>=e||!wa(e))return"";var o=e-r;return n=null==n?" ":n+"",yi(n,ga(o/n.length)).slice(0,o)}function An(t,e,n,r){function o(){for(var e=-1,u=arguments.length,s=-1,c=r.length,l=Bi(c+u);++s<c;)l[s]=r[s];for(;u--;)l[s++]=arguments[++e];var p=this&&this!==re&&this instanceof o?a:t;return p.apply(i?n:this,l)}var i=e&C,a=yn(t);return o}function Rn(t){var e=Fi[t];return function(t,n){return n=n===P?0:+n||0,n?(n=ca(10,n),e(t*n)/n):e(t)}}function Un(t){return function(e,n,r,o){var i=Bn(r);return null==r&&i===we?rn(e,n,t):on(e,n,i(r,o,1),t)}}function zn(t,e,n,r,o,i,a,u){var s=e&I;if(!s&&"function"!=typeof t)throw new Hi(F);var c=r?r.length:0;if(c||(e&=~(A|R),r=o=P),c-=o?o.length:0,e&R){var l=r,p=o;r=o=P}var f=s?P:Ba(t),h=[t,e,n,r,o,l,p,i,a,u];if(f&&(or(h,f),e=h[1],u=h[9]),h[9]=null==u?s?0:t.length:xa(u-c,0)||0,e==C)var d=dn(h[0],h[2]);else d=e!=A&&e!=(C|A)||h[4].length?Tn.apply(P,h):An.apply(P,h);var v=f?Na:Va;return v(d,h)}function Ln(t,e,n,r,o,i,a){var u=-1,s=t.length,c=e.length;if(s!=c&&!(o&&c>s))return!1;for(;++u<s;){var l=t[u],p=e[u],f=r?r(o?p:l,o?l:p,u):P;if(f!==P){if(f)continue;return!1}if(o){if(!fe(e,function(t){return l===t||n(l,t,r,o,i,a)}))return!1}else if(l!==p&&!n(l,p,r,o,i,a))return!1}return!0}function qn(t,e,n){switch(n){case K:case H:return+t==+e;case J:return t.name==e.name&&t.message==e.message;case tt:return t!=+t?e!=+e:t==+e;case nt:case ot:return t==e+""}return!1}function Nn(t,e,n,r,o,i,a){var u=Nu(t),s=u.length,c=Nu(e),l=c.length;if(s!=l&&!o)return!1;for(var p=s;p--;){var f=u[p];if(!(o?f in e:ea.call(e,f)))return!1}for(var h=o;++p<s;){f=u[p];var d=t[f],v=e[f],g=r?r(o?v:d,o?d:v,f):P;if(!(g===P?n(d,v,r,o,i,a):g))return!1;h||(h="constructor"==f)}if(!h){var y=t.constructor,b=e.constructor;if(y!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b))return!1}return!0}function Bn(t,n,r){var o=e.callback||Ei;return o=o===Ei?we:o,r?o(t,n,r):o}function $n(t){for(var e=t.name,n=Aa[e],r=n?n.length:0;r--;){var o=n[r],i=o.func;if(null==i||i==t)return o.name}return e}function Vn(t,n,r){var o=e.indexOf||_r;return o=o===_r?u:o,t?o(t,n,r):o}function Gn(t){for(var e=ni(t),n=e.length;n--;)e[n][2]=rr(e[n][1]);return e}function Fn(t,e){var n=null==t?P:t[e];return Lo(n)?n:P}function Wn(t,e,n){for(var r=-1,o=n.length;++r<o;){var i=n[r],a=i.size;switch(i.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=Oa(e,t+a);break;case"takeRight":t=xa(t,e-a)}}return{start:t,end:e}}function Yn(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&ea.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Xn(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Yi),new e}function Kn(t,e,n){var r=t.constructor;switch(e){case at:return un(t);case K:case H:return new r(+t);case ut:case st:case ct:case lt:case pt:case ft:case ht:case dt:case vt:var o=t.buffer;return new r(n?un(o):o,t.byteOffset,t.length);case tt:case ot:return new r(t);case nt:var i=new r(t.source,At.exec(t));i.lastIndex=t.lastIndex}return i}function Hn(t,e,n){null==t||tr(e,t)||(e=fr(e),t=1==e.length?t:Ae(t,Xe(e,0,-1)),e=Er(e));var r=null==t?t:t[e];return null==r?P:r.apply(t,n)}function Jn(t){return null!=t&&nr($a(t))}function Zn(t,e){return t="number"==typeof t||zt.test(t)?+t:-1,e=null==e?Ta:e,t>-1&&t%1==0&&e>t}function Qn(t,e,n){if(!Ro(n))return!1;var r=typeof e;if("number"==r?Jn(n)&&Zn(e,n.length):"string"==r&&e in n){var o=n[e];return t===t?t===o:o!==o}return!1}function tr(t,e){var n=typeof t;if("string"==n&&Pt.test(t)||"number"==n)return!0;if(Cu(t))return!1;var r=!Et.test(t);return r||null!=e&&t in pr(e)}function er(t){var n=$n(t);if(!(n in o.prototype))return!1;var r=e[n];if(t===r)return!0;var i=Ba(r);return!!i&&t===i[0]}function nr(t){return"number"==typeof t&&t>-1&&t%1==0&&Ta>=t}function rr(t){return t===t&&!Ro(t)}function or(t,e){var n=t[1],r=e[1],o=n|r,i=U>o,a=r==U&&n==T||r==U&&n==z&&t[7].length<=e[8]||r==(U|z)&&n==T;if(!i&&!a)return t;r&C&&(t[2]=e[2],o|=n&C?0:S);var u=e[3];if(u){var s=t[3];t[3]=s?sn(s,u,e[4]):te(u),t[4]=s?j(t[3],W):te(e[4])}return u=e[5],u&&(s=t[5],t[5]=s?cn(s,u,e[6]):te(u),t[6]=s?j(t[5],W):te(e[6])),u=e[7],u&&(t[7]=te(u)),r&U&&(t[8]=null==t[8]?e[8]:Oa(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=o,t}function ir(t,e){return t===P?e:Iu(t,e,ir)}function ar(t,e){t=pr(t);for(var n=-1,r=e.length,o={};++n<r;){var i=e[n];i in t&&(o[i]=t[i])}return o}function ur(t,e){var n={};return Ie(t,function(t,r,o){e(t,r,o)&&(n[r]=t)}),n}function sr(t,e){for(var n=t.length,r=Oa(e.length,n),o=te(t);r--;){var i=e[r];t[r]=Zn(i,n)?o[i]:P}return t}function cr(t){for(var e=ei(t),n=e.length,r=n&&t.length,o=!!r&&nr(r)&&(Cu(t)||Eo(t)),i=-1,a=[];++i<n;){var u=e[i];(o&&Zn(u,r)||ea.call(t,u))&&a.push(u)}return a}function lr(t){return null==t?[]:Jn(t)?Ro(t)?t:Yi(t):ai(t)}function pr(t){return Ro(t)?t:Yi(t)}function fr(t){if(Cu(t))return t;var e=[];return c(t).replace(Mt,function(t,n,r,o){e.push(r?o.replace(Tt,"$1"):n||t)}),e}function hr(t){return t instanceof o?t.clone():new r(t.__wrapped__,t.__chain__,te(t.__actions__))}function dr(t,e,n){e=(n?Qn(t,e,n):null==e)?1:xa(ba(e)||1,1);for(var r=0,o=t?t.length:0,i=-1,a=Bi(ga(o/e));o>r;)a[++i]=Xe(t,r,r+=e);return a}function vr(t){for(var e=-1,n=t?t.length:0,r=-1,o=[];++e<n;){var i=t[e];i&&(o[++r]=i)}return o}function gr(t,e,n){var r=t?t.length:0;return r?((n?Qn(t,e,n):null==e)&&(e=1),Xe(t,0>e?0:e)):[]}function yr(t,e,n){var r=t?t.length:0;return r?((n?Qn(t,e,n):null==e)&&(e=1),e=r-(+e||0),Xe(t,0,0>e?0:e)):[]}function br(t,e,n){return t&&t.length?en(t,Bn(e,n,3),!0,!0):[]}function mr(t,e,n){return t&&t.length?en(t,Bn(e,n,3),!0):[]}function wr(t,e,n,r){var o=t?t.length:0;return o?(n&&"number"!=typeof n&&Qn(t,e,n)&&(n=0,r=o),Ee(t,e,n,r)):[]}function jr(t){return t?t[0]:P}function xr(t,e,n){var r=t?t.length:0;return n&&Qn(t,e,n)&&(e=!1),r?Ce(t,e):[]}function Or(t){var e=t?t.length:0;return e?Ce(t,!0):[]}function _r(t,e,n){var r=t?t.length:0;if(!r)return-1;if("number"==typeof n)n=0>n?xa(r+n,0):n;else if(n){var o=rn(t,e);return r>o&&(e===e?e===t[o]:t[o]!==t[o])?o:-1}return u(t,e,n||0)}function kr(t){return yr(t,1)}function Er(t){var e=t?t.length:0;return e?t[e-1]:P}function Pr(t,e,n){var r=t?t.length:0;if(!r)return-1;var o=r;if("number"==typeof n)o=(0>n?xa(r+n,0):Oa(n||0,r-1))+1;else if(n){o=rn(t,e,!0)-1;var i=t[o];return(e===e?e===i:i!==i)?o:-1}if(e!==e)return b(t,o,!0);for(;o--;)if(t[o]===e)return o;return-1}function Mr(){var t=arguments,e=t[0];if(!e||!e.length)return e;for(var n=0,r=Vn(),o=t.length;++n<o;)for(var i=0,a=t[n];(i=r(e,a,i))>-1;)ha.call(e,i,1);return e}function Cr(t,e,n){var r=[];if(!t||!t.length)return r;var o=-1,i=[],a=t.length;for(e=Bn(e,n,3);++o<a;){var u=t[o];e(u,o,t)&&(r.push(u),i.push(o))}return Fe(t,i),r}function Ir(t){return gr(t,1)}function Sr(t,e,n){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&Qn(t,e,n)&&(e=0,n=r),Xe(t,e,n)):[]}function Tr(t,e,n){var r=t?t.length:0;return r?((n?Qn(t,e,n):null==e)&&(e=1),Xe(t,0,0>e?0:e)):[]}function Dr(t,e,n){var r=t?t.length:0;return r?((n?Qn(t,e,n):null==e)&&(e=1),e=r-(+e||0),Xe(t,0>e?0:e)):[]}function Ar(t,e,n){return t&&t.length?en(t,Bn(e,n,3),!1,!0):[]}function Rr(t,e,n){return t&&t.length?en(t,Bn(e,n,3)):[]}function Ur(t,e,n,r){var o=t?t.length:0;if(!o)return[];null!=e&&"boolean"!=typeof e&&(r=n,n=Qn(t,e,r)?P:e,e=!1);var i=Bn();return(null!=n||i!==we)&&(n=i(n,r,3)),e&&Vn()==u?x(t,n):Qe(t,n)}function zr(t){if(!t||!t.length)return[];var e=-1,n=0;t=ue(t,function(t){return Jn(t)?(n=xa(t.length,n),!0):void 0});for(var r=Bi(n);++e<n;)r[e]=se(t,Ve(e));return r}function Lr(t,e,n){var r=t?t.length:0;if(!r)return[];var o=zr(t);return null==e?o:(e=an(e,n,4),se(o,function(t){return le(t,e,P,!0)}))}function qr(){for(var t=-1,e=arguments.length;++t<e;){var n=arguments[t];if(Jn(n))var r=r?ce(Oe(r,n),Oe(n,r)):n}return r?Qe(r):[]}function Nr(t,e){var n=-1,r=t?t.length:0,o={};for(!r||e||Cu(t[0])||(e=[]);++n<r;){var i=t[n];e?o[i]=e[n]:i&&(o[i[0]]=i[1])}return o}function Br(t){var n=e(t);return n.__chain__=!0,n}function $r(t,e,n){return e.call(n,t),t}function Vr(t,e,n){return e.call(n,t)}function Gr(){return Br(this)}function Fr(){return new r(this.value(),this.__chain__)}function Wr(t){for(var e,r=this;r instanceof n;){var o=hr(r);e?i.__wrapped__=o:e=o;var i=o;r=r.__wrapped__}return i.__wrapped__=t,e}function Yr(){var t=this.__wrapped__,e=function(t){return n&&n.__dir__<0?t:t.reverse()};if(t instanceof o){var n=t;return this.__actions__.length&&(n=new o(this)),n=n.reverse(),n.__actions__.push({func:Vr,args:[e],thisArg:P}),new r(n,this.__chain__)}return this.thru(e)}function Xr(){return this.value()+""}function Kr(){return nn(this.__wrapped__,this.__actions__)}function Hr(t,e,n){var r=Cu(t)?ie:_e;return n&&Qn(t,e,n)&&(e=P),("function"!=typeof e||n!==P)&&(e=Bn(e,n,3)),r(t,e)}function Jr(t,e,n){var r=Cu(t)?ue:Pe;return e=Bn(e,n,3),r(t,e)}function Zr(t,e){return ou(t,qe(e))}function Qr(t,e,n,r){var o=t?$a(t):0;return nr(o)||(t=ai(t),o=t.length),n="number"!=typeof n||r&&Qn(e,n,r)?0:0>n?xa(o+n,0):n||0,"string"==typeof t||!Cu(t)&&Vo(t)?o>=n&&t.indexOf(e,n)>-1:!!o&&Vn(t,e,n)>-1}function to(t,e,n){var r=Cu(t)?se:Le;return e=Bn(e,n,3),r(t,e)}function eo(t,e){return to(t,Ai(e))}function no(t,e,n){var r=Cu(t)?ue:Pe;return e=Bn(e,n,3),r(t,function(t,n,r){return!e(t,n,r)})}function ro(t,e,n){if(n?Qn(t,e,n):null==e){t=lr(t);var r=t.length;return r>0?t[We(0,r-1)]:P}var o=-1,i=Xo(t),r=i.length,a=r-1;for(e=Oa(0>e?0:+e||0,r);++o<e;){var u=We(o,a),s=i[u];i[u]=i[o],i[o]=s}return i.length=e,i}function oo(t){return ro(t,Ma)}function io(t){var e=t?$a(t):0;return nr(e)?e:Nu(t).length}function ao(t,e,n){var r=Cu(t)?fe:Ke;return n&&Qn(t,e,n)&&(e=P),("function"!=typeof e||n!==P)&&(e=Bn(e,n,3)),r(t,e)}function uo(t,e,n){if(null==t)return[];n&&Qn(t,e,n)&&(e=P);var r=-1;e=Bn(e,n,3);var o=Le(t,function(t,n,o){return{criteria:e(t,n,o),index:++r,value:t}});return He(o,f)}function so(t,e,n,r){return null==t?[]:(r&&Qn(e,n,r)&&(n=P),Cu(e)||(e=null==e?[]:[e]),Cu(n)||(n=null==n?[]:[n]),Je(t,e,n))}function co(t,e){return Jr(t,qe(e))}function lo(t,e){if("function"!=typeof e){if("function"!=typeof t)throw new Hi(F);var n=t;t=e,e=n}return t=wa(t=+t)?t:0,function(){return--t<1?e.apply(this,arguments):void 0}}function po(t,e,n){return n&&Qn(t,e,n)&&(e=P),e=t&&null==e?t.length:xa(+e||0,0),zn(t,U,P,P,P,P,e)}function fo(t,e){var n;if("function"!=typeof e){if("function"!=typeof t)throw new Hi(F);var r=t;t=e,e=r}return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=P),n}}function ho(t,e,n){function r(){h&&ua(h),c&&ua(c),v=0,c=h=d=P}function o(e,n){n&&ua(n),c=h=d=P,e&&(v=vu(),l=t.apply(f,s),h||c||(s=f=P))}function i(){var t=e-(vu()-p);0>=t||t>e?o(d,c):h=fa(i,t)}function a(){o(y,h)}function u(){if(s=arguments,p=vu(),f=this,d=y&&(h||!b),g===!1)var n=b&&!h;else{c||b||(v=p);var r=g-(p-v),o=0>=r||r>g;o?(c&&(c=ua(c)),v=p,l=t.apply(f,s)):c||(c=fa(a,r))}return o&&h?h=ua(h):h||e===g||(h=fa(i,e)),n&&(o=!0,l=t.apply(f,s)),!o||h||c||(s=f=P),l}var s,c,l,p,f,h,d,v=0,g=!1,y=!0;if("function"!=typeof t)throw new Hi(F);if(e=0>e?0:+e||0,n===!0){var b=!0;y=!1}else Ro(n)&&(b=!!n.leading,g="maxWait"in n&&xa(+n.maxWait||0,e),y="trailing"in n?!!n.trailing:y);return u.cancel=r,u}function vo(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new Hi(F);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new vo.Cache,n}function go(t){if("function"!=typeof t)throw new Hi(F);return function(){return!t.apply(this,arguments)}}function yo(t){return fo(2,t)}function bo(t,e){if("function"!=typeof t)throw new Hi(F);return e=xa(e===P?t.length-1:+e||0,0),function(){for(var n=arguments,r=-1,o=xa(n.length-e,0),i=Bi(o);++r<o;)i[r]=n[e+r];switch(e){case 0:return t.call(this,i);case 1:return t.call(this,n[0],i);case 2:return t.call(this,n[0],n[1],i)}var a=Bi(e+1);for(r=-1;++r<e;)a[r]=n[r];return a[e]=i,t.apply(this,a)}}function mo(t){if("function"!=typeof t)throw new Hi(F);return function(e){return t.apply(this,e)}}function wo(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new Hi(F);return n===!1?r=!1:Ro(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),ho(t,e,{leading:r,maxWait:+e,trailing:o})}function jo(t,e){return e=null==e?Mi:e,zn(e,A,P,[t],[])}function xo(t,e,n,r){return e&&"boolean"!=typeof e&&Qn(t,e,n)?e=!1:"function"==typeof e&&(r=n,n=e,e=!1),"function"==typeof n?je(t,e,an(n,r,1)):je(t,e)}function Oo(t,e,n){return"function"==typeof e?je(t,!0,an(e,n,1)):je(t,!0)}function _o(t,e){return t>e}function ko(t,e){return t>=e}function Eo(t){return m(t)&&Jn(t)&&ea.call(t,"callee")&&!la.call(t,"callee")}function Po(t){return t===!0||t===!1||m(t)&&ra.call(t)==K}function Mo(t){return m(t)&&ra.call(t)==H}function Co(t){return!!t&&1===t.nodeType&&m(t)&&!Bo(t)}function Io(t){return null==t?!0:Jn(t)&&(Cu(t)||Vo(t)||Eo(t)||m(t)&&Ao(t.splice))?!t.length:!Nu(t).length}function So(t,e,n,r){n="function"==typeof n?an(n,r,3):P;var o=n?n(t,e):P;return o===P?Re(t,e,n):!!o}function To(t){return m(t)&&"string"==typeof t.message&&ra.call(t)==J}function Do(t){return"number"==typeof t&&wa(t)}function Ao(t){return Ro(t)&&ra.call(t)==Z}function Ro(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Uo(t,e,n,r){
return n="function"==typeof n?an(n,r,3):P,ze(t,Gn(e),n)}function zo(t){return No(t)&&t!=+t}function Lo(t){return null==t?!1:Ao(t)?ia.test(ta.call(t)):m(t)&&Ut.test(t)}function qo(t){return null===t}function No(t){return"number"==typeof t||m(t)&&ra.call(t)==tt}function Bo(t){var e;if(!m(t)||ra.call(t)!=et||Eo(t)||!ea.call(t,"constructor")&&(e=t.constructor,"function"==typeof e&&!(e instanceof e)))return!1;var n;return Ie(t,function(t,e){n=e}),n===P||ea.call(t,n)}function $o(t){return Ro(t)&&ra.call(t)==nt}function Vo(t){return"string"==typeof t||m(t)&&ra.call(t)==ot}function Go(t){return m(t)&&nr(t.length)&&!!Gt[ra.call(t)]}function Fo(t){return t===P}function Wo(t,e){return e>t}function Yo(t,e){return e>=t}function Xo(t){var e=t?$a(t):0;return nr(e)?e?te(t):[]:ai(t)}function Ko(t){return me(t,ei(t))}function Ho(t,e,n){var r=Ra(t);return n&&Qn(t,e,n)&&(e=P),e?ye(r,e):r}function Jo(t){return De(t,ei(t))}function Zo(t,e,n){var r=null==t?P:Ae(t,fr(e),e+"");return r===P?n:r}function Qo(t,e){if(null==t)return!1;var n=ea.call(t,e);if(!n&&!tr(e)){if(e=fr(e),t=1==e.length?t:Ae(t,Xe(e,0,-1)),null==t)return!1;e=Er(e),n=ea.call(t,e)}return n||nr(t.length)&&Zn(e,t.length)&&(Cu(t)||Eo(t))}function ti(t,e,n){n&&Qn(t,e,n)&&(e=P);for(var r=-1,o=Nu(t),i=o.length,a={};++r<i;){var u=o[r],s=t[u];e?ea.call(a,s)?a[s].push(u):a[s]=[u]:a[s]=u}return a}function ei(t){if(null==t)return[];Ro(t)||(t=Yi(t));var e=t.length;e=e&&nr(e)&&(Cu(t)||Eo(t))&&e||0;for(var n=t.constructor,r=-1,o="function"==typeof n&&n.prototype===t,i=Bi(e),a=e>0;++r<e;)i[r]=r+"";for(var u in t)a&&Zn(u,e)||"constructor"==u&&(o||!ea.call(t,u))||i.push(u);return i}function ni(t){t=pr(t);for(var e=-1,n=Nu(t),r=n.length,o=Bi(r);++e<r;){var i=n[e];o[e]=[i,t[i]]}return o}function ri(t,e,n){var r=null==t?P:t[e];return r===P&&(null==t||tr(e,t)||(e=fr(e),t=1==e.length?t:Ae(t,Xe(e,0,-1)),r=null==t?P:t[Er(e)]),r=r===P?n:r),Ao(r)?r.call(t):r}function oi(t,e,n){if(null==t)return t;var r=e+"";e=null!=t[r]||tr(e,t)?[r]:fr(e);for(var o=-1,i=e.length,a=i-1,u=t;null!=u&&++o<i;){var s=e[o];Ro(u)&&(o==a?u[s]=n:null==u[s]&&(u[s]=Zn(e[o+1])?[]:{})),u=u[s]}return t}function ii(t,e,n,r){var o=Cu(t)||Go(t);if(e=Bn(e,r,4),null==n)if(o||Ro(t)){var i=t.constructor;n=o?Cu(t)?new i:[]:Ra(Ao(i)?i.prototype:P)}else n={};return(o?ee:Se)(t,function(t,r,o){return e(n,t,r,o)}),n}function ai(t){return tn(t,Nu(t))}function ui(t){return tn(t,ei(t))}function si(t,e,n){return e=+e||0,n===P?(n=e,e=0):n=+n||0,t>=Oa(e,n)&&t<xa(e,n)}function ci(t,e,n){n&&Qn(t,e,n)&&(e=n=P);var r=null==t,o=null==e;if(null==n&&(o&&"boolean"==typeof t?(n=t,t=1):"boolean"==typeof e&&(n=e,o=!0)),r&&o&&(e=1,o=!1),t=+t||0,o?(e=t,t=0):e=+e||0,n||t%1||e%1){var i=Ea();return Oa(t+i*(e-t+sa("1e-"+((i+"").length-1))),e)}return We(t,e)}function li(t){return t=c(t),t&&t.charAt(0).toUpperCase()+t.slice(1)}function pi(t){return t=c(t),t&&t.replace(Lt,d).replace(St,"")}function fi(t,e,n){t=c(t),e+="";var r=t.length;return n=n===P?r:Oa(0>n?0:+n||0,r),n-=e.length,n>=0&&t.indexOf(e,n)==n}function hi(t){return t=c(t),t&&xt.test(t)?t.replace(wt,v):t}function di(t){return t=c(t),t&&It.test(t)?t.replace(Ct,g):t||"(?:)"}function vi(t,e,n){t=c(t),e=+e;var r=t.length;if(r>=e||!wa(e))return t;var o=(e-r)/2,i=ba(o),a=ga(o);return n=Dn("",a,n),n.slice(0,i)+t+n}function gi(t,e,n){return(n?Qn(t,e,n):null==e)?e=0:e&&(e=+e),t=wi(t),ka(t,e||(Rt.test(t)?16:10))}function yi(t,e){var n="";if(t=c(t),e=+e,1>e||!t||!wa(e))return n;do e%2&&(n+=t),e=ba(e/2),t+=t;while(e);return n}function bi(t,e,n){return t=c(t),n=null==n?0:Oa(0>n?0:+n||0,t.length),t.lastIndexOf(e,n)==n}function mi(t,n,r){var o=e.templateSettings;r&&Qn(t,n,r)&&(n=r=P),t=c(t),n=ge(ye({},r||n),o,ve);var i,a,u=ge(ye({},n.imports),o.imports,ve),s=Nu(u),l=tn(u,s),p=0,f=n.interpolate||qt,h="__p += '",d=Xi((n.escape||qt).source+"|"+f.source+"|"+(f===kt?Dt:qt).source+"|"+(n.evaluate||qt).source+"|$","g"),v="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++Vt+"]")+"\n";t.replace(d,function(e,n,r,o,u,s){return r||(r=o),h+=t.slice(p,s).replace(Nt,y),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),u&&(a=!0,h+="';\n"+u+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),p=s+e.length,e}),h+="';\n";var g=n.variable;g||(h="with (obj) {\n"+h+"\n}\n"),h=(a?h.replace(gt,""):h).replace(yt,"$1").replace(bt,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var b=Ju(function(){return Gi(s,v+"return "+h).apply(P,l)});if(b.source=h,To(b))throw b;return b}function wi(t,e,n){var r=t;return(t=c(t))?(n?Qn(r,e,n):null==e)?t.slice(O(t),_(t)+1):(e+="",t.slice(l(t,e),p(t,e)+1)):t}function ji(t,e,n){var r=t;return t=c(t),t?(n?Qn(r,e,n):null==e)?t.slice(O(t)):t.slice(l(t,e+"")):t}function xi(t,e,n){var r=t;return t=c(t),t?(n?Qn(r,e,n):null==e)?t.slice(0,_(t)+1):t.slice(0,p(t,e+"")+1):t}function Oi(t,e,n){n&&Qn(t,e,n)&&(e=P);var r=L,o=q;if(null!=e)if(Ro(e)){var i="separator"in e?e.separator:i;r="length"in e?+e.length||0:r,o="omission"in e?c(e.omission):o}else r=+e||0;if(t=c(t),r>=t.length)return t;var a=r-o.length;if(1>a)return o;var u=t.slice(0,a);if(null==i)return u+o;if($o(i)){if(t.slice(a).search(i)){var s,l,p=t.slice(0,a);for(i.global||(i=Xi(i.source,(At.exec(i)||"")+"g")),i.lastIndex=0;s=i.exec(p);)l=s.index;u=u.slice(0,null==l?a:l)}}else if(t.indexOf(i,a)!=a){var f=u.lastIndexOf(i);f>-1&&(u=u.slice(0,f))}return u+o}function _i(t){return t=c(t),t&&jt.test(t)?t.replace(mt,k):t}function ki(t,e,n){return n&&Qn(t,e,n)&&(e=P),t=c(t),t.match(e||Bt)||[]}function Ei(t,e,n){return n&&Qn(t,e,n)&&(e=P),m(t)?Ci(t):we(t,e)}function Pi(t){return function(){return t}}function Mi(t){return t}function Ci(t){return qe(je(t,!0))}function Ii(t,e){return Ne(t,je(e,!0))}function Si(t,e,n){if(null==n){var r=Ro(e),o=r?Nu(e):P,i=o&&o.length?De(e,o):P;(i?i.length:r)||(i=!1,n=e,e=t,t=this)}i||(i=De(e,Nu(e)));var a=!0,u=-1,s=Ao(t),c=i.length;n===!1?a=!1:Ro(n)&&"chain"in n&&(a=n.chain);for(;++u<c;){var l=i[u],p=e[l];t[l]=p,s&&(t.prototype[l]=function(e){return function(){var n=this.__chain__;if(a||n){var r=t(this.__wrapped__),o=r.__actions__=te(this.__actions__);return o.push({func:e,args:arguments,thisArg:t}),r.__chain__=n,r}return e.apply(t,ce([this.value()],arguments))}}(p))}return t}function Ti(){return re._=oa,this}function Di(){}function Ai(t){return tr(t)?Ve(t):Ge(t)}function Ri(t){return function(e){return Ae(t,fr(e),e+"")}}function Ui(t,e,n){n&&Qn(t,e,n)&&(e=n=P),t=+t||0,n=null==n?1:+n||0,null==e?(e=t,t=0):e=+e||0;for(var r=-1,o=xa(ga((e-t)/(n||1)),0),i=Bi(o);++r<o;)i[r]=t,t+=n;return i}function zi(t,e,n){if(t=ba(t),1>t||!wa(t))return[];var r=-1,o=Bi(Oa(t,Ca));for(e=an(e,n,1);++r<t;)Ca>r?o[r]=e(r):e(r);return o}function Li(t){var e=++na;return c(t)+e}function qi(t,e){return(+t||0)+(+e||0)}function Ni(t,e,n){return n&&Qn(t,e,n)&&(e=P),e=Bn(e,n,3),1==e.length?he(Cu(t)?t:lr(t),e):Ze(t,e)}t=t?oe.defaults(re.Object(),t,oe.pick(re,$t)):re;var Bi=t.Array,$i=t.Date,Vi=t.Error,Gi=t.Function,Fi=t.Math,Wi=t.Number,Yi=t.Object,Xi=t.RegExp,Ki=t.String,Hi=t.TypeError,Ji=Bi.prototype,Zi=Yi.prototype,Qi=Ki.prototype,ta=Gi.prototype.toString,ea=Zi.hasOwnProperty,na=0,ra=Zi.toString,oa=re._,ia=Xi("^"+ta.call(ea).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),aa=t.ArrayBuffer,ua=t.clearTimeout,sa=t.parseFloat,ca=Fi.pow,la=Zi.propertyIsEnumerable,pa=Fn(t,"Set"),fa=t.setTimeout,ha=Ji.splice,da=t.Uint8Array,va=Fn(t,"WeakMap"),ga=Fi.ceil,ya=Fn(Yi,"create"),ba=Fi.floor,ma=Fn(Bi,"isArray"),wa=t.isFinite,ja=Fn(Yi,"keys"),xa=Fi.max,Oa=Fi.min,_a=Fn($i,"now"),ka=t.parseInt,Ea=Fi.random,Pa=Wi.NEGATIVE_INFINITY,Ma=Wi.POSITIVE_INFINITY,Ca=4294967295,Ia=Ca-1,Sa=Ca>>>1,Ta=9007199254740991,Da=va&&new va,Aa={};e.support={};e.templateSettings={escape:Ot,evaluate:_t,interpolate:kt,variable:"",imports:{_:e}};var Ra=function(){function t(){}return function(e){if(Ro(e)){t.prototype=e;var n=new t;t.prototype=P}return n||{}}}(),Ua=fn(Se),za=fn(Te,!0),La=hn(),qa=hn(!0),Na=Da?function(t,e){return Da.set(t,e),t}:Mi,Ba=Da?function(t){return Da.get(t)}:Di,$a=Ve("length"),Va=function(){var t=0,e=0;return function(n,r){var o=vu(),i=B-(o-e);if(e=o,i>0){if(++t>=N)return n}else t=0;return Na(n,r)}}(),Ga=bo(function(t,e){return m(t)&&Jn(t)?Oe(t,Ce(e,!1,!0)):[]}),Fa=xn(),Wa=xn(!0),Ya=bo(function(t){for(var e=t.length,n=e,r=Bi(p),o=Vn(),i=o==u,a=[];n--;){var s=t[n]=Jn(s=t[n])?s:[];r[n]=i&&s.length>=120?vn(n&&s):null}var c=t[0],l=-1,p=c?c.length:0,f=r[0];t:for(;++l<p;)if(s=c[l],(f?Jt(f,s):o(a,s,0))<0){for(var n=e;--n;){var h=r[n];if((h?Jt(h,s):o(t[n],s,0))<0)continue t}f&&f.push(s),a.push(s)}return a}),Xa=bo(function(t,e){e=Ce(e);var n=be(t,e);return Fe(t,e.sort(i)),n}),Ka=Un(),Ha=Un(!0),Ja=bo(function(t){return Qe(Ce(t,!1,!0))}),Za=bo(function(t,e){return Jn(t)?Oe(t,e):[]}),Qa=bo(zr),tu=bo(function(t){var e=t.length,n=e>2?t[e-2]:P,r=e>1?t[e-1]:P;return e>2&&"function"==typeof n?e-=2:(n=e>1&&"function"==typeof r?(--e,r):P,r=P),t.length=e,Lr(t,n,r)}),eu=bo(function(t){return t=Ce(t),this.thru(function(e){return Qt(Cu(e)?e:[pr(e)],t)})}),nu=bo(function(t,e){return be(t,Ce(e))}),ru=ln(function(t,e,n){ea.call(t,n)?++t[n]:t[n]=1}),ou=jn(Ua),iu=jn(za,!0),au=kn(ee,Ua),uu=kn(ne,za),su=ln(function(t,e,n){ea.call(t,n)?t[n].push(e):t[n]=[e]}),cu=ln(function(t,e,n){t[n]=e}),lu=bo(function(t,e,n){var r=-1,o="function"==typeof e,i=tr(e),a=Jn(t)?Bi(t.length):[];return Ua(t,function(t){var u=o?e:i&&null!=t?t[e]:P;a[++r]=u?u.apply(t,n):Hn(t,e,n)}),a}),pu=ln(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),fu=Sn(le,Ua),hu=Sn(pe,za),du=bo(function(t,e){if(null==t)return[];var n=e[2];return n&&Qn(e[0],e[1],n)&&(e.length=1),Je(t,Ce(e),[])}),vu=_a||function(){return(new $i).getTime()},gu=bo(function(t,e,n){var r=C;if(n.length){var o=j(n,gu.placeholder);r|=A}return zn(t,r,e,n,o)}),yu=bo(function(t,e){e=e.length?Ce(e):Jo(t);for(var n=-1,r=e.length;++n<r;){var o=e[n];t[o]=zn(t[o],C,t)}return t}),bu=bo(function(t,e,n){var r=C|I;if(n.length){var o=j(n,bu.placeholder);r|=A}return zn(e,r,t,n,o)}),mu=bn(T),wu=bn(D),ju=bo(function(t,e){return xe(t,1,e)}),xu=bo(function(t,e,n){return xe(t,e,n)}),Ou=_n(),_u=_n(!0),ku=bo(function(t,e){if(e=Ce(e),"function"!=typeof t||!ie(e,s))throw new Hi(F);var n=e.length;return bo(function(r){for(var o=Oa(r.length,n);o--;)r[o]=e[o](r[o]);return t.apply(this,r)})}),Eu=In(A),Pu=In(R),Mu=bo(function(t,e){return zn(t,z,P,P,P,Ce(e))}),Cu=ma||function(t){return m(t)&&nr(t.length)&&ra.call(t)==X},Iu=pn(Be),Su=pn(function(t,e,n){return n?ge(t,e,n):ye(t,e)}),Tu=mn(Su,de),Du=mn(Iu,ir),Au=On(Se),Ru=On(Te),Uu=En(La),zu=En(qa),Lu=Pn(Se),qu=Pn(Te),Nu=ja?function(t){var e=null==t?P:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&Jn(t)?cr(t):Ro(t)?ja(t):[]}:cr,Bu=Mn(!0),$u=Mn(),Vu=bo(function(t,e){if(null==t)return{};if("function"!=typeof e[0]){var e=se(Ce(e),Ki);return ar(t,Oe(ei(t),e))}var n=an(e[0],e[1],3);return ur(t,function(t,e,r){return!n(t,e,r)})}),Gu=bo(function(t,e){return null==t?{}:"function"==typeof e[0]?ur(t,an(e[0],e[1],3)):ar(t,Ce(e))}),Fu=gn(function(t,e,n){return e=e.toLowerCase(),t+(n?e.charAt(0).toUpperCase()+e.slice(1):e)}),Wu=gn(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Yu=Cn(),Xu=Cn(!0),Ku=gn(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Hu=gn(function(t,e,n){return t+(n?" ":"")+(e.charAt(0).toUpperCase()+e.slice(1))}),Ju=bo(function(t,e){try{return t.apply(P,e)}catch(n){return To(n)?n:new Vi(n)}}),Zu=bo(function(t,e){return function(n){return Hn(n,t,e)}}),Qu=bo(function(t,e){return function(n){return Hn(t,n,e)}}),ts=Rn("ceil"),es=Rn("floor"),ns=wn(_o,Pa),rs=wn(Wo,Ma),os=Rn("round");return e.prototype=n.prototype,r.prototype=Ra(n.prototype),r.prototype.constructor=r,o.prototype=Ra(n.prototype),o.prototype.constructor=o,it.prototype["delete"]=Wt,it.prototype.get=Yt,it.prototype.has=Xt,it.prototype.set=Kt,Ht.prototype.push=Zt,vo.Cache=it,e.after=lo,e.ary=po,e.assign=Su,e.at=nu,e.before=fo,e.bind=gu,e.bindAll=yu,e.bindKey=bu,e.callback=Ei,e.chain=Br,e.chunk=dr,e.compact=vr,e.constant=Pi,e.countBy=ru,e.create=Ho,e.curry=mu,e.curryRight=wu,e.debounce=ho,e.defaults=Tu,e.defaultsDeep=Du,e.defer=ju,e.delay=xu,e.difference=Ga,e.drop=gr,e.dropRight=yr,e.dropRightWhile=br,e.dropWhile=mr,e.fill=wr,e.filter=Jr,e.flatten=xr,e.flattenDeep=Or,e.flow=Ou,e.flowRight=_u,e.forEach=au,e.forEachRight=uu,e.forIn=Uu,e.forInRight=zu,e.forOwn=Lu,e.forOwnRight=qu,e.functions=Jo,e.groupBy=su,e.indexBy=cu,e.initial=kr,e.intersection=Ya,e.invert=ti,e.invoke=lu,e.keys=Nu,e.keysIn=ei,e.map=to,e.mapKeys=Bu,e.mapValues=$u,e.matches=Ci,e.matchesProperty=Ii,e.memoize=vo,e.merge=Iu,e.method=Zu,e.methodOf=Qu,e.mixin=Si,e.modArgs=ku,e.negate=go,e.omit=Vu,e.once=yo,e.pairs=ni,e.partial=Eu,e.partialRight=Pu,e.partition=pu,e.pick=Gu,e.pluck=eo,e.property=Ai,e.propertyOf=Ri,e.pull=Mr,e.pullAt=Xa,e.range=Ui,e.rearg=Mu,e.reject=no,e.remove=Cr,e.rest=Ir,e.restParam=bo,e.set=oi,e.shuffle=oo,e.slice=Sr,e.sortBy=uo,e.sortByAll=du,e.sortByOrder=so,e.spread=mo,e.take=Tr,e.takeRight=Dr,e.takeRightWhile=Ar,e.takeWhile=Rr,e.tap=$r,e.throttle=wo,e.thru=Vr,e.times=zi,e.toArray=Xo,e.toPlainObject=Ko,e.transform=ii,e.union=Ja,e.uniq=Ur,e.unzip=zr,e.unzipWith=Lr,e.values=ai,e.valuesIn=ui,e.where=co,e.without=Za,e.wrap=jo,e.xor=qr,e.zip=Qa,e.zipObject=Nr,e.zipWith=tu,e.backflow=_u,e.collect=to,e.compose=_u,e.each=au,e.eachRight=uu,e.extend=Su,e.iteratee=Ei,e.methods=Jo,e.object=Nr,e.select=Jr,e.tail=Ir,e.unique=Ur,Si(e,e),e.add=qi,e.attempt=Ju,e.camelCase=Fu,e.capitalize=li,e.ceil=ts,e.clone=xo,e.cloneDeep=Oo,e.deburr=pi,e.endsWith=fi,e.escape=hi,e.escapeRegExp=di,e.every=Hr,e.find=ou,e.findIndex=Fa,e.findKey=Au,e.findLast=iu,e.findLastIndex=Wa,e.findLastKey=Ru,e.findWhere=Zr,e.first=jr,e.floor=es,e.get=Zo,e.gt=_o,e.gte=ko,e.has=Qo,e.identity=Mi,e.includes=Qr,e.indexOf=_r,e.inRange=si,e.isArguments=Eo,e.isArray=Cu,e.isBoolean=Po,e.isDate=Mo,e.isElement=Co,e.isEmpty=Io,e.isEqual=So,e.isError=To,e.isFinite=Do,e.isFunction=Ao,e.isMatch=Uo,e.isNaN=zo,e.isNative=Lo,e.isNull=qo,e.isNumber=No,e.isObject=Ro,e.isPlainObject=Bo,e.isRegExp=$o,e.isString=Vo,e.isTypedArray=Go,e.isUndefined=Fo,e.kebabCase=Wu,e.last=Er,e.lastIndexOf=Pr,e.lt=Wo,e.lte=Yo,e.max=ns,e.min=rs,e.noConflict=Ti,e.noop=Di,e.now=vu,e.pad=vi,e.padLeft=Yu,e.padRight=Xu,e.parseInt=gi,e.random=ci,e.reduce=fu,e.reduceRight=hu,e.repeat=yi,e.result=ri,e.round=os,e.runInContext=E,e.size=io,e.snakeCase=Ku,e.some=ao,e.sortedIndex=Ka,e.sortedLastIndex=Ha,e.startCase=Hu,e.startsWith=bi,e.sum=Ni,e.template=mi,e.trim=wi,e.trimLeft=ji,e.trimRight=xi,e.trunc=Oi,e.unescape=_i,e.uniqueId=Li,e.words=ki,e.all=Hr,e.any=ao,e.contains=Qr,e.eq=So,e.detect=ou,e.foldl=fu,e.foldr=hu,e.head=jr,e.include=Qr,e.inject=fu,Si(e,function(){var t={};return Se(e,function(n,r){e.prototype[r]||(t[r]=n)}),t}(),!1),e.sample=ro,e.prototype.sample=function(t){return this.__chain__||null!=t?this.thru(function(e){return ro(e,t)}):ro(this.value())},e.VERSION=M,ee(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){e[t].placeholder=e}),ee(["drop","take"],function(t,e){o.prototype[t]=function(n){var r=this.__filtered__;if(r&&!e)return new o(this);n=null==n?1:xa(ba(n)||0,0);var i=this.clone();return r?i.__takeCount__=Oa(i.__takeCount__,n):i.__views__.push({size:n,type:t+(i.__dir__<0?"Right":"")}),i},o.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),ee(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n!=G;o.prototype[t]=function(t,e){var o=this.clone();return o.__iteratees__.push({iteratee:Bn(t,e,1),type:n}),o.__filtered__=o.__filtered__||r,o}}),ee(["first","last"],function(t,e){var n="take"+(e?"Right":"");o.prototype[t]=function(){return this[n](1).value()[0]}}),ee(["initial","rest"],function(t,e){var n="drop"+(e?"":"Right");o.prototype[t]=function(){return this.__filtered__?new o(this):this[n](1)}}),ee(["pluck","where"],function(t,e){var n=e?"filter":"map",r=e?qe:Ai;o.prototype[t]=function(t){return this[n](r(t))}}),o.prototype.compact=function(){return this.filter(Mi)},o.prototype.reject=function(t,e){return t=Bn(t,e,1),this.filter(function(e){return!t(e)})},o.prototype.slice=function(t,e){t=null==t?0:+t||0;var n=this;return n.__filtered__&&(t>0||0>e)?new o(n):(0>t?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==P&&(e=+e||0,n=0>e?n.dropRight(-e):n.take(e-t)),n)},o.prototype.takeRightWhile=function(t,e){return this.reverse().takeWhile(t,e).reverse()},o.prototype.toArray=function(){return this.take(Ma)},Se(o.prototype,function(t,n){var i=/^(?:filter|map|reject)|While$/.test(n),a=/^(?:first|last)$/.test(n),u=e[a?"take"+("last"==n?"Right":""):n];u&&(e.prototype[n]=function(){var e=a?[1]:arguments,n=this.__chain__,s=this.__wrapped__,c=!!this.__actions__.length,l=s instanceof o,p=e[0],f=l||Cu(s);f&&i&&"function"==typeof p&&1!=p.length&&(l=f=!1);var h=function(t){return a&&n?u(t,1)[0]:u.apply(P,ce([t],e))},d={func:Vr,args:[h],thisArg:P},v=l&&!c;if(a&&!n)return v?(s=s.clone(),s.__actions__.push(d),t.call(s)):u.call(P,this.value())[0];if(!a&&f){s=v?s:new o(this);var g=t.apply(s,e);return g.__actions__.push(d),new r(g,n)}return this.thru(h)})}),ee(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(t){var n=(/^(?:replace|split)$/.test(t)?Qi:Ji)[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",o=/^(?:join|pop|replace|shift)$/.test(t);e.prototype[t]=function(){var t=arguments;return o&&!this.__chain__?n.apply(this.value(),t):this[r](function(e){return n.apply(e,t)})}}),Se(o.prototype,function(t,n){var r=e[n];if(r){var o=r.name,i=Aa[o]||(Aa[o]=[]);i.push({name:n,func:r})}}),Aa[Tn(P,I).name]=[{name:"wrapper",func:P}],o.prototype.clone=w,o.prototype.reverse=Q,o.prototype.value=rt,e.prototype.chain=Gr,e.prototype.commit=Fr,e.prototype.concat=eu,e.prototype.plant=Wr,e.prototype.reverse=Yr,e.prototype.toString=Xr,e.prototype.run=e.prototype.toJSON=e.prototype.valueOf=e.prototype.value=Kr,e.prototype.collect=e.prototype.map,e.prototype.head=e.prototype.first,e.prototype.select=e.prototype.filter,e.prototype.tail=e.prototype.rest,e}var P,M="3.10.1",C=1,I=2,S=4,T=8,D=16,A=32,R=64,U=128,z=256,L=30,q="...",N=150,B=16,$=200,V=1,G=2,F="Expected a function",W="__lodash_placeholder__",Y="[object Arguments]",X="[object Array]",K="[object Boolean]",H="[object Date]",J="[object Error]",Z="[object Function]",Q="[object Map]",tt="[object Number]",et="[object Object]",nt="[object RegExp]",rt="[object Set]",ot="[object String]",it="[object WeakMap]",at="[object ArrayBuffer]",ut="[object Float32Array]",st="[object Float64Array]",ct="[object Int8Array]",lt="[object Int16Array]",pt="[object Int32Array]",ft="[object Uint8Array]",ht="[object Uint8ClampedArray]",dt="[object Uint16Array]",vt="[object Uint32Array]",gt=/\b__p \+= '';/g,yt=/\b(__p \+=) '' \+/g,bt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,mt=/&(?:amp|lt|gt|quot|#39|#96);/g,wt=/[&<>"'`]/g,jt=RegExp(mt.source),xt=RegExp(wt.source),Ot=/<%-([\s\S]+?)%>/g,_t=/<%([\s\S]+?)%>/g,kt=/<%=([\s\S]+?)%>/g,Et=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,Pt=/^\w*$/,Mt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,Ct=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,It=RegExp(Ct.source),St=/[\u0300-\u036f\ufe20-\ufe23]/g,Tt=/\\(\\)?/g,Dt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,At=/\w*$/,Rt=/^0[xX]/,Ut=/^\[object .+?Constructor\]$/,zt=/^\d+$/,Lt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,qt=/($^)/,Nt=/['\n\r\u2028\u2029\\]/g,Bt=function(){var t="[A-Z\\xc0-\\xd6\\xd8-\\xde]",e="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(t+"+(?="+t+e+")|"+t+"?"+e+"|"+t+"+|[0-9]+","g")}(),$t=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],Vt=-1,Gt={};Gt[ut]=Gt[st]=Gt[ct]=Gt[lt]=Gt[pt]=Gt[ft]=Gt[ht]=Gt[dt]=Gt[vt]=!0,Gt[Y]=Gt[X]=Gt[at]=Gt[K]=Gt[H]=Gt[J]=Gt[Z]=Gt[Q]=Gt[tt]=Gt[et]=Gt[nt]=Gt[rt]=Gt[ot]=Gt[it]=!1;var Ft={};Ft[Y]=Ft[X]=Ft[at]=Ft[K]=Ft[H]=Ft[ut]=Ft[st]=Ft[ct]=Ft[lt]=Ft[pt]=Ft[tt]=Ft[et]=Ft[nt]=Ft[ot]=Ft[ft]=Ft[ht]=Ft[dt]=Ft[vt]=!0,Ft[J]=Ft[Z]=Ft[Q]=Ft[rt]=Ft[it]=!1;var Wt={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},Yt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Xt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Kt={"function":!0,object:!0},Ht={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Jt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Zt=Kt[typeof e]&&e&&!e.nodeType&&e,Qt=Kt[typeof t]&&t&&!t.nodeType&&t,te=Zt&&Qt&&"object"==typeof o&&o&&o.Object&&o,ee=Kt[typeof self]&&self&&self.Object&&self,ne=Kt[typeof window]&&window&&window.Object&&window,re=(Qt&&Qt.exports===Zt&&Zt,te||ne!==(this&&this.window)&&ne||ee||this),oe=E();re._=oe,r=function(){return oe}.call(e,n,e,t),!(r!==P&&(t.exports=r))}).call(this)}).call(e,n(9)(t),function(){return this}())},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";window.requestAnimationFrame=window.requestAnimationFrame||function(t){return setTimeout(t,60)}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(){return!1}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(8),p=r(l),f=n(6),h=r(f),d=n(12),v=n(13),g=r(v),y=n(17),b=r(y),m=n(18),w=r(m),j=n(19),x=r(j),O=n(20),_=r(O),k=n(21),E=r(k),P=n(22),M=r(P),C=n(23),I=r(C),S=n(24),T=r(S),D=n(25),A=r(D),R=function(t){function e(){var t;o(this,e);for(var n=arguments.length,r=Array(n),a=0;n>a;a++)r[a]=arguments[a];var u=i(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.bindings={},u.componentCache={},u}return a(e,t),c(e,[{key:"componentDidMount",value:function(){function t(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}var e=this;this.props.controller.on("stateChange",function(){e.forceUpdate()}),this.props.controller.on("stateChange",p["default"].throttle(function(){e.errors=e.props.controller.getStateErrors()},500)),this.refs.content.tabIndex=0,this.refs.content.focus(),this.refs.stage.node.on("click",function(){e.refs.content.focus()});var n=0,r=this.refs.stage.node,o=r.getContent();o.style.transform="translateZ(0)",document.body.style.display="none",setTimeout(function(){document.body.style.display="initial"},100),o.oncontextmenu=function(){return!1},o.addEventListener("touchmove",function(r){var o=r.touches[0],i=r.touches[1];if(o&&i){r.stopPropagation();var a=t({x:o.clientX,y:o.clientY},{x:i.clientX,y:i.clientY});n||(n=a);var u=a/n;e.props.controller.scaleBy(u),n=a}},!1),o.addEventListener("touchend",function(){n=0},!1),o.addEventListener("wheel",this.handleMousewheel.bind(this)),this.requiestCheckAutoScroll()}},{key:"componentDidUpdate",value:function(){var t=this.state.panMode?"grab":"initial";document.body.cursor=t,document.body.cursor!==t&&(document.body.cursor="-webkit-grab")}},{key:"handleMousewheel",value:function(t){t.preventDefault();var e=t.deltaY>0?.95:1.05;this.props.controller.scaleBy(e)}},{key:"handleCanvasKeyDown",value:function(t){if(t.target===this.refs.content){(8===t.keyCode||46===t.keyCode)&&(t.preventDefault(),this.props.controller.deleteSelected());var e=t.ctrlKey||t.metaKey;65===t.keyCode&&e&&(t.preventDefault(),this.props.controller.selectAll()),90===t.keyCode&&e&&(t.preventDefault(),this.props.controller.undo()),89===t.keyCode&&e&&(t.preventDefault(),this.props.controller.redo())}}},{key:"requiestCheckAutoScroll",value:function(){var t=this.refs.stage.node,e=t.getPointerPosition(),n=p["default"].find(this.state.objects,function(t){return t.isDragging}),r=this.state.tempConnect.show;(n||r)&&this.props.controller.checkAutoScroll(e),setTimeout(this.requiestCheckAutoScroll.bind(this),50)}},{key:"action",value:function(t){return this.bindings[t]||(this.bindings[t]=this.props.controller[t].bind(this.props.controller)),this.bindings[t]}},{key:"binded",value:function(t){if(!this[t])throw new Error("Unknow method "+t);return this.hasOwnProperty(t)||(this[t]=this[t].bind(this)),this[t]}},{key:"getObjectComponents",value:function(t){var e=this;t||(t=this.state.objects.filter(function(t){return!t.parent}));var n=[];t.forEach(function(t){if(e.props.controller.isObjectOnScreen(t.id)){var r=t.showChildren&&t.children.length>0,o=r&&t.children.map(function(t){return e.props.controller.getObject(t)}),i=e.props.controller.shouldHighligh(t.id),a=!!t.referenceOf,u=a&&e.props.controller.getObject(t.referenceOf),s=p["default"].find(e.errors,function(e){return e.targetId===t.id}),c=h["default"].createElement(g["default"],{key:t.id,object:t,isSelected:p["default"].includes(e.state.selectedObjects,t.id),hasErrors:s,isHighlighted:i,viewport:e.state.viewport,multipleSelectionMode:e.state.multipleSelectionMode,maxFontSize:e.state.maxFontSize,referenceObject:u,scale:e.state.viewport.scale,settingsIcon:e.state.settingsIcon,settingsTooltipText:e.state.settingsTooltipText,bookmarkIcon:e.state.bookmarkIcon,bookmarkTooltipText:e.state.bookmarkTooltipText,goToReferenceIcon:e.state.goToReferenceIcon,goToReferenceTooltipText:e.state.goToReferenceTooltipText,fitViewportIcon:e.state.fitViewportIcon,fitViewportTooltipText:e.state.fitViewportTooltipText,drillUpIcon:e.state.drillUpIcon,drillUpTooltipText:e.state.drillUpTooltipText,drillDownIcon:e.state.drillDownIcon,drillDownTooltipText:e.state.drillDownTooltipText,updateObject:e.action("updateObject"),selectObject:e.action("selectObject"),deselectAll:e.action("deselectAll"),deselectItem:e.action("deselectItem"),createTempConnect:e.action("createTempConnect"),resizeObject:e.action("resizeObject"),getObjectAbsolutePosition:e.action("getObjectAbsolutePosition"),isObjectOnScreen:e.action("isObjectOnScreen"),updatePort:e.action("updatePort"),trigger:e.action("trigger"),drillUp:e.action("drillUp"),drillDown:e.action("drillDown"),fitViewport:e.action("fitViewport"),showAdvancedProperties:e.action("showAdvancedProperties"),createBookmark:e.action("createBookmark"),onObjectDragMove:e.action("onObjectDragMove"),onObjectDragEnd:e.action("onObjectDragEnd"),onObjectDragStart:e.action("onObjectDragStart"),checkAutoScroll:e.action("checkAutoScroll"),showTooltip:e.action("showTooltip"),hideTooltip:e.action("hideTooltip"),isOverlap:e.action("isOverlap"),children:r?e.getObjectComponents(o):void 0});n.push(c)}});var r=t[0]&&!t[0].parent;return r?p["default"].chunk(n,50).map(function(t,n){return h["default"].createElement(d.Layer,{hitGraphEnabled:!e.state.panMode,key:n,scaleX:e.state.viewport.scale,scaleY:e.state.viewport.scale,x:-e.state.viewport.x*e.state.viewport.scale,y:-e.state.viewport.y*e.state.viewport.scale,name:"objects-layer"+n},t)}):n}},{key:"getConnectComponents",value:function(){var t=this;return this.state.connects.map(function(e){var n=e.ports.map(function(e){var n=t.props.controller.getObjectByPort(e);return s({},n,{visible:t.props.controller.isObjectVisible(n.id)})}),r=p["default"].find(t.errors,function(t){return t.targetId===e.id});return h["default"].createElement(b["default"],s({},e,{key:e.id,isSelected:p["default"].includes(t.state.selectedConnects,e.id),hasErrors:r,multipleSelectionMode:t.state.multipleSelectionMode,selectConnect:t.action("selectConnect"),deselectAll:t.action("deselectAll"),deselectItem:t.action("deselectItem"),getObjectAbsolutePosition:t.action("getObjectAbsolutePosition"),objects:n}))})}},{key:"handlaBackDragStart",value:function(t){t.target.stopDrag(),t.target.position({x:0,y:0}),t.target.getLayer().draw();var e=this.props.controller,n=t.target.getStage().getPointerPosition();this.state.panMode?e.createPanDragger(n):e.createSelector(n)}},{key:"render",value:function(){var t=this.props.controller.state;return h["default"].createElement("div",{style:{position:"relative"},onContextMenu:u,onKeyDown:this.binded("handleCanvasKeyDown"),ref:"content"},h["default"].createElement(d.Stage,{x:.5,y:.5,width:t.width,height:t.height,ref:"stage"},h["default"].createElement(d.Layer,{name:"back-layer"},h["default"].createElement(d.Rect,{x:0,y:0,width:this.state.width,height:this.state.height,draggable:!0,fill:"lightgrey",dragDistance:5,onClick:this.action("deselectAll"),onTap:this.action("deselectAll"),onDragStart:this.binded("handlaBackDragStart")}),h["default"].createElement(I["default"],s({},this.state.panDragger,{viewport:this.state.viewport,updateViewport:this.action("updateViewport"),deletePanDragger:this.action("deletePanDragger")}))),this.getObjectComponents(),h["default"].createElement(d.Layer,{scaleX:this.state.viewport.scale,scaleY:this.state.viewport.scale,x:-this.state.viewport.x*this.state.viewport.scale,y:-this.state.viewport.y*this.state.viewport.scale,name:"connector-layer"},this.getConnectComponents(),h["default"].createElement(x["default"],s({},this.state.selector,{selectObjectsInArea:this.action("selectObjectsInArea"),scale:this.state.viewport.scale})),h["default"].createElement(w["default"],s({},this.state.tempConnect,{checkAutoScroll:this.action("checkAutoScroll"),removeTempConnect:this.action("removeTempConnect"),connectPorts:this.action("connectPorts")}))),h["default"].createElement(d.Layer,{name:"scrollbal-tooltip-layer"},h["default"].createElement(M["default"],{width:this.state.width,height:this.state.height,viewport:this.state.viewport,updateViewport:this.action("updateViewport")}),h["default"].createElement(T["default"],this.state.tooltip))),h["default"].createElement(_["default"],{show:this.state.showCreateChipPrompt,hidePrompt:this.action("hidePrompt"),submitPrompt:this.action("createChipWithSelectedObjects")}),h["default"].createElement(A["default"],s({},this.state.advancedProperties,{hideAdvancedProperties:this.action("hideAdvancedProperties"),object:this.props.controller.getObject(this.state.advancedProperties.object),updateObject:this.action("updateObject"),getObjectInputs:this.action("getObjectInputs"),objects:this.state.objects,expressionTree:this.state.expressionTree})),h["default"].createElement(E["default"],s({},this.state,{updateViewport:this.action("updateViewport"),getObjectByPort:this.action("getObjectByPort"),changeScaleLevel:this.action("changeScaleLevel"),getObjectAbsolutePosition:this.action("getObjectAbsolutePosition")
})))}},{key:"state",get:function(){return this.props.controller.state},set:function(t){}}]),e}(h["default"].Component);e["default"]=R},function(t,e){"use strict";var n=window.ReactKonva;t.exports=n},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function o(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(6),p=o(l),f=n(12),h=n(14),d=o(h),v=n(15),g=r(v),y=n(16),b=o(y),m={width:8,height:8,fill:"orange",offsetX:4,offsetY:4,draggable:!0},w=40,j=function(t){function e(){i(this,e);for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];var o=a(this,Object.getPrototypeOf(e).call(this,n)),u=["handleDragStart","handleDragMove","handleDragEnd","handleClick","handleDblClick","handleTopLeftResizerMove","handleTopLeftResizerEnd","handleTopRightResizerMove","handleTopRightResizerEnd","handleBottomLeftResizerMove","handleBottomLeftResizerEnd","handleBottomRightResizerMove","handleBottomRightResizerEnd","handleTextClick","handleMouseLeave","handleMouseMove","handleMouseEnter"];return u.forEach(function(t){o[t]=o[t].bind(o)}),o.state={isMouseOver:!1},o}return u(e,t),c(e,[{key:"componentDidMount",value:function(){this.checkVisibility(),!this.props.object.isDragging||this.refs.topGroup.isDragging()||this.props.inPreview||this.refs.topGroup.startDrag()}},{key:"shouldComponentUpdate",value:function(t,e){return this.checkVisibility(),t.children&&t.children.length?!0:this.props.object!==t.object||this.props.isSelected!==t.isSelected||this.props.hasErrors!==t.hasErrors||this.props.isHighlighted!==t.isHighlighted||this.props.scale!==t.scale||this.state.isMouseOver!==e.isMouseOver}},{key:"componentDidUpdate",value:function(t){t.viewport!==this.props.viewport&&this.checkVisibility()}},{key:"checkVisibility",value:function(){}},{key:"handleDragStart",value:function(t){t.target===this.refs.topGroup&&this.props.onObjectDragStart(this.props.object.id)}},{key:"handleDragEnd",value:function(t){return t.target===this.refs.topGroup?this.props.isOverlap(this.props.object.id,this.refs.topGroup.position())?void this.props.onObjectDragEnd(this.props.object.id,{x:this.props.object.x,y:this.props.object.y}):void this.props.onObjectDragEnd(this.props.object.id,this.refs.topGroup.position()):void 0}},{key:"handleDragMove",value:function(t){if(t.target===this.refs.topGroup){window.Konva.DD.anim.dirty=!1;var e=this.refs.topGroup.getStage().getPointerPosition(),n=this.refs.topGroup.position();if(this.props.isOverlap(this.props.object.id,n))return void t.target.position({x:this.props.object.x,y:this.props.object.y});this.props.onObjectDragMove(this.props.object.id,n),this.props.showTooltip({x:e.x,y:e.y,text:this.props.object.name})}}},{key:"handleClick",value:function(t){var e=t.evt.shiftKey||t.evt.ctrlKey||t.evt.metaKey,n=e||this.props.multipleSelectionMode;this.props.multipleSelectionMode&&this.props.isSelected?this.props.deselectItem(this.props.object.id):(n||this.props.deselectAll(),this.props.selectObject(this.props.object.id,e)),this.props.trigger("object-click",[this.props.object,t.evt])}},{key:"handleDblClick",value:function(t){"gate"===this.props.object.type?this.props.showAdvancedProperties(this.props.object.id):this.props.object.showChildren?this.props.drillUp(this.props.object.id):this.props.drillDown(this.props.object.id),this.props.trigger("object-dblclick",[this.props.object,t.evt])}},{key:"handleTopLeftResizerMove",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=t.target.attrs,r=n.x,o=n.y;Konva.DD.anim.dirty=!1;var i=this.props.object.width-r,a=this.props.object.height-o;return w>i||w>a?void this.forceUpdate():(this.props.resizeObject(this.props.object.id,{x:this.props.object.x+r,y:this.props.object.y+o,width:i,height:a},e),clearTimeout(this.mouseLeaveTimeout),void this.setState({isMouseOver:!0}))}},{key:"handleTopLeftResizerEnd",value:function(t){this.handleTopLeftResizerMove(t,!1)}},{key:"handleTopRightResizerMove",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=t.target.attrs,r=n.x,o=n.y;Konva.DD.anim.dirty=!1;var i=r,a=this.props.object.height-o;return w>i||w>a?void this.forceUpdate():(this.props.resizeObject(this.props.object.id,{y:this.props.object.y+o,width:i,height:a},e),clearTimeout(this.mouseLeaveTimeout),void this.setState({isMouseOver:!0}))}},{key:"handleTopRightResizerEnd",value:function(t){this.handleTopRightResizerMove(t,!1)}},{key:"handleBottomLeftResizerMove",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=t.target.attrs,r=n.x,o=n.y;Konva.DD.anim.dirty=!1;var i=this.props.object.width-r,a=o;return w>i||w>a?void this.forceUpdate():(this.props.resizeObject(this.props.object.id,{x:this.props.object.x+r,width:i,height:a},e),clearTimeout(this.mouseLeaveTimeout),void this.setState({isMouseOver:!0}))}},{key:"handleBottomLeftResizerEnd",value:function(t){this.handleBottomLeftResizerMove(t,!1)}},{key:"handleBottomRightResizerMove",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=t.target.attrs,r=n.x,o=n.y;Konva.DD.anim.dirty=!1;var i=r,a=o;return w>i||w>a?void this.forceUpdate():(this.props.resizeObject(this.props.object.id,{width:r,height:o},e),clearTimeout(this.mouseLeaveTimeout),void this.setState({isMouseOver:!0}))}},{key:"handleBottomRightResizerEnd",value:function(t){this.handleBottomRightResizerMove(t,!1)}},{key:"handleTextClick",value:function(){this.props.referenceObject&&this.props.fitViewport(this.props.referenceObject.id)}},{key:"handleMouseMove",value:function(t){var e=t.target.getStage().getPointerPosition();this.props.showTooltip({x:e.x,y:e.y,text:this.props.object.name})}},{key:"handleMouseEnter",value:function(){clearTimeout(this.mouseLeaveTimeout),g.showPointer(),this.setState({isMouseOver:!0})}},{key:"handleMouseLeave",value:function(){var t=this;(0,v.hidePointer)(),this.props.hideTooltip(),this.mouseLeaveTimeout=setTimeout(function(){t.setState({isMouseOver:!1})},500)}},{key:"getPortsComponents",value:function(){var t=this;return this.props.object.ports.map(function(e){return p["default"].createElement(b["default"],{visible:!t.props.inPreview,key:e.id,object:t.props.object,port:e,createTempConnect:t.props.createTempConnect,updatePort:t.props.updatePort,getObjectAbsolutePosition:t.props.getObjectAbsolutePosition})})}},{key:"getResizersComponents",value:function(){if(this.props.inPreview)return null;if(!this.props.isSelected&&!this.state.isMouseOver)return null;var t=this.props.object,e=t.width,n=t.height,r=this.props.scale,o=s({},m,{width:m.width/r,height:m.height/r,offsetX:m.offsetX/r,offsetY:m.offsetY/r});return p["default"].createElement(f.Group,null,p["default"].createElement(f.Rect,s({},o,{x:0,y:0,ref:"topLeftResizer",onDragMove:this.handleTopLeftResizerMove,onDragEnd:this.handleTopLeftResizerEnd,onMouseMove:g.cursorFunc("nwse-resize")})),p["default"].createElement(f.Rect,s({},o,{x:e,y:0,ref:"topRightResizer",onDragMove:this.handleTopRightResizerMove,onDragEnd:this.handleTopRightResizerEnd,onMouseOver:g.cursorFunc("nesw-resize"),onMouseLeave:g.cursorFunc("initial")})),p["default"].createElement(f.Rect,s({},o,{x:e,y:n,ref:"bottomRightResizer",onDragMove:this.handleBottomRightResizerMove,onDragEnd:this.handleBottomRightResizerEnd,onMouseOver:g.cursorFunc("nwse-resize"),onMouseLeave:g.cursorFunc("initial")})),p["default"].createElement(f.Rect,s({},o,{x:0,y:n,ref:"bottomLeftResizer",onDragMove:this.handleBottomLeftResizerMove,onDragEnd:this.handleBottomLeftResizerEnd,onMouseOver:g.cursorFunc("nesw-resize"),onMouseLeave:g.cursorFunc("initial")})))}},{key:"render",value:function(){var t=this.props.object,e=t.dropTarget?"#5389c8":this.props.isHighlighted?"#6aff79":"#6AAEFF",n=t.name||"GATE "+t.id,r="\n<"+t.type+" "+t.subType+">",o=!this.props.inPreview&&"gate"===this.props.object.type,i=this.props.referenceObject?"\n<REF: "+this.props.referenceObject.name+">":"",a=o?n+r:n,u=30,c=Math.min(this.props.maxFontSize||10,Math.min((t.width-2*u)/Math.max(n.length,r.length)*1.5,t.height/3)),l=Math.min(this.props.maxFontSize||10,Math.min((t.width-2*u)/i.length*1.6,t.height/4));return p["default"].createElement(f.Group,{draggable:!this.props.inPreview,dragDistance:10,transformsEnabled:"position",x:t.x,y:t.y,name:"object "+t.type,opacity:t.isDragging?.6:1,ref:"topGroup",onDragStart:this.handleDragStart,onDragend:this.handleDragEnd,onDragMove:this.handleDragMove,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},p["default"].createElement(f.Group,{onClick:this.handleClick,onTap:this.handleClick,onDblclick:this.handleDblClick,onDbltap:this.handleDblClick,onMouseMove:this.handleMouseMove,ref:"mainGroup"},p["default"].createElement(f.Rect,{width:t.width,height:t.height,fill:e,name:"back",strokeHitEnabled:!1,stroke:this.props.isSelected?"green":this.props.hasErrors?"red":"black",strokeWidth:this.props.isSelected?5:1}),p["default"].createElement(f.Text,{y:t.height/2-c-u,padding:u,width:t.width,align:"center",listening:!1,text:a,fontSize:c,visible:!this.props.inPreview,onClick:this.handleTextClick,onTap:this.handleTextClick,fill:"white"}),p["default"].createElement(f.Text,{y:t.height/2+c/2-u,padding:u,width:t.width,align:"center",text:i,fontSize:l,fontStyle:"italic",visible:!this.props.inPreview,onClick:this.handleTextClick,onTap:this.handleTextClick,fill:"white"})),this.getResizersComponents(),this.getPortsComponents(),p["default"].createElement(d["default"],s({},this.props,{show:this.props.isSelected})),this.props.children)}}]),e}(p["default"].Component);e["default"]=j},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){var e=void 0;return t.drillUpIcon?(x.src=t.drillUpIcon,e=b["default"].createElement(m.Image,{image:x,y:t.y,width:t.size,height:t.size})):e=b["default"].createElement(m.Text,v({},w,{y:t.y,fontSize:t.size,text:" "})),b["default"].createElement(j,v({action:t.drillUp},t,{tooltipText:t.drillUpTooltipText||"drill up"}),e)}function c(t){var e=void 0;return t.drillDownIcon?(O.src=t.drillDownIcon,e=b["default"].createElement(m.Image,{image:O,y:t.y,width:t.size,height:t.size})):e=b["default"].createElement(m.Text,v({},w,{y:t.y,fontSize:t.size,text:" "})),b["default"].createElement(j,v({action:t.drillDown},t,{tooltipText:t.drillDownTooltipText||"drill down"}),e)}function l(t){var e=void 0;return t.fitViewportIcon?(_.src=t.fitViewportIcon,e=b["default"].createElement(m.Image,{image:_,y:t.y,width:t.size,height:t.size})):e=b["default"].createElement(m.Text,v({},w,{y:t.y,fontSize:t.size,text:""})),b["default"].createElement(j,v({action:t.fitViewport},t,{tooltipText:t.fitViewportTooltipText||"fit viewport"}),e)}function p(t){var e=void 0;return t.goToReferenceIcon?(k.src=t.goToReferenceIcon,e=b["default"].createElement(m.Image,{image:k,y:t.y,width:t.size,height:t.size})):e=b["default"].createElement(m.Text,v({},w,{y:t.y,fontSize:t.size,text:""})),b["default"].createElement(j,v({action:t.fitViewport.bind(null,t.referenceObject.id)},t,{tooltipText:t.goToReferenceTooltipText||"go to reference"}),e)}function f(t){var e=void 0;return t.bookmarkIcon?(E.src=t.bookmarkIcon,e=b["default"].createElement(m.Image,{image:E,y:t.y,width:t.size,height:t.size})):e=b["default"].createElement(m.Text,v({},w,{y:t.y,fontSize:t.size,text:""})),b["default"].createElement(j,v({action:t.createBookmark},t,{tooltipText:t.bookmarkTooltipText||"create bookmark"}),e)}function h(t){function e(e){t.trigger("object-properties-click",[t.object,e.evt])}var n=void 0;return t.settingsIcon?(P.src=t.settingsIcon,n=b["default"].createElement(m.Image,{image:P,y:t.y,width:t.size,height:t.size,onClick:e,onTap:e})):n=b["default"].createElement(m.Text,v({},w,{y:t.y,fontSize:t.size,text:"",onClick:e,onTap:e})),b["default"].createElement(j,v({action:t.showAdvancedProperties},t,{tooltipText:t.settingsTooltipText||"open settings"}),n)}function d(t){if(!t.show)return b["default"].createElement(m.Group,null);var e=t.object.width,n=M[t.object.type];if(!n)return console.error("Unknow object type "+t.object.type),b["default"].createElement(m.Group,null);t.referenceObject&&(n=[].concat(o(n),[p]));var r=n.map(function(e,n){var r=w.size/t.scale;return b["default"].createElement(e,v({},t,{y:(r+3)*n,size:r,key:n}))});return b["default"].createElement(m.Group,{x:e+7},r)}Object.defineProperty(e,"__esModule",{value:!0});var v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},g=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e["default"]=d;var y=n(6),b=r(y),m=n(12),w={size:20,align:"center"},j=function(t){function e(){var t;i(this,e);for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];var u=a(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.handleClick=u.handleClick.bind(u),u.handleMouseMove=u.handleMouseOver.bind(u),u.handleMouseLeave=u.handleMouseLeave.bind(u),u}return u(e,t),g(e,[{key:"handleClick",value:function(){this.props.action(this.props.object.id)}},{key:"handleMouseOver",value:function(t){var e=t.target.getStage().getPointerPosition();this.props.showTooltip({x:e.x,y:e.y,text:this.props.tooltipText})}},{key:"handleMouseLeave",value:function(){this.props.hideTooltip()}},{key:"render",value:function(){return b["default"].createElement(m.Group,{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick,onTap:this.handleClick},this.props.children)}}]),e}(b["default"].Component),x=new window.Image,O=new window.Image,_=new window.Image,k=new window.Image,E=new window.Image,P=new window.Image,M={gate:[l,h,f],chip:[s,c,l,h,f]}},function(t,e){"use strict";function n(){document.body.style.cursor="pointer"}function r(){document.body.style.cursor="default"}function o(t){return function(){document.body.style.cursor=t}}function i(){document.body.style.cursor="scale-in","scale-in"!==document.body.style.cursor&&(document.body.style.cursor="-webkit-scale-in"),"-webkit-scale-in"!==document.body.style.cursor&&(document.body.style.cursor="-moz-scale-in")}function a(t,e){return t.x>e.x+e.width||t.y>e.y+e.height?!1:t.x+t.width<e.x?!1:t.y+t.height<e.y?!1:!0}function u(t,e){var n=0;return t.x-n>e.x+e.width?!1:t.x+t.width+n<e.x?!1:t.y-n>e.y+e.height?!1:t.y+t.height+n<e.y?!1:!0}function s(t,e,n,r,o,i,a,u){var s=void 0,c=void 0,l=void 0,p=void 0,f=void 0,h={x:null,y:null,onLine1:!1,onLine2:!1};return s=(u-i)*(n-t)-(a-o)*(r-e),0==s?h:(c=e-i,l=t-o,p=(a-o)*c-(u-i)*l,f=(n-t)*c-(r-e)*l,c=p/s,l=f/s,h.x=t+c*(n-t),h.y=e+c*(r-e),c>0&&1>c&&(h.onLine1=!0),l>0&&1>l&&(h.onLine2=!0),h.onLine1&&h.onLine2)}function c(t,e){return t.x>e.x&&t.x<e.x+e.width&&t.y>e.y&&t.y<e.y+e.height}function l(t,e){var n=[e[0].x,e[0].y,e[1].x,e[1].y],r=s.apply(null,[t.x,t.y,t.x+t.width,t.y].concat(n)),o=s.apply(null,[t.x+t.width,t.y,t.x+t.width,t.y+t.height].concat(n)),i=s.apply(null,[t.x,t.y+t.height,t.x+t.width,t.y+t.height].concat(n)),a=s.apply(null,[t.x,t.y,t.x,t.y+t.height].concat(n)),u=c(e[0],t)&&c(e[1],t);return r||o||i||a||u}Object.defineProperty(e,"__esModule",{value:!0}),e.showPointer=n,e.hidePointer=r,e.cursorFunc=o,e.showScaleCursor=i,e.isInside=a,e.isOverlap=u,e.isRectIntersectLine=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){var e=t.object,n=e.width,r=e.height,o=t.port.position,i=n/2,a=r/2,u=void 0,s=void 0,c=void 0;return o>=0&&o<Math.PI/4||7*Math.PI/4<o&&o<=2*Math.PI?(u=i+n/2,s=a-Math.sin(o)*r/2/Math.sin(Math.PI/4),c=0):o>=Math.PI/4&&o<3*Math.PI/4?(u=i+Math.cos(o)*n/2/Math.sin(Math.PI/4),s=a-r/2,c=-90):o>=3*Math.PI/4&&o<5*Math.PI/4?(u=i-n/2,s=a-Math.sin(o)*r/2/Math.sin(Math.PI/4),c=180):o>=5*Math.PI/4&&o<=7*Math.PI/4?(u=i+Math.cos(o)*n/2/Math.sin(Math.PI/4),s=a+r/2,c=90):console.error("Unsupported port position",o),"input"===t.port.type&&(c+=180),{x:u,y:s,rotation:c}}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.findPortPos=u;var l=n(6),p=r(l),f=n(12),h=n(8),d=function(t){function e(){var t;o(this,e);for(var n=arguments.length,r=Array(n),a=0;n>a;a++)r[a]=arguments[a];var u=i(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.inputArrow=[-5,0,5,0],u.outputArrow=[-5,0,5,0],u.handleDragStart=u.handleDragStart.bind(u),u.handleDragMove=u.handleDragMove.bind(u),u.handleDragEnd=u.handleDragEnd.bind(u),u.handleDblClick=u.handleDblClick.bind(u),u}return a(e,t),c(e,[{key:"componentDidMount",value:function(){this.isMoving=!1,this.cache()}},{key:"shouldComponentUpdate",value:function(t){var e=this.props.object.width!==t.object.width,n=this.props.object.height!==t.object.height;return e||n||!(0,h.isEqual)(this.props.port,t.port)}},{key:"componentDidUpdate",value:function(t){this.props.port.name!==t.port.name&&this.cache()}},{key:"cache",value:function(){this.refs.group.clearCache(),this.refs.group.cache()}},{key:"handleDragStart",value:function(t){if(this.isMoving)return void this.refs.group.clearCache();t.target.stopDrag();var e=t.target.getStage().getPointerPosition();this.props.createTempConnect(this.props.port.id,e),this.forceUpdate()}},{key:"handleDragMove",value:function(){if(this.isMoving){var t=this.refs.group.getStage().getPointerPosition(),e=this.props.object.width/2,n=this.props.object.height/2,r=e/n,o=this.refs.group.getLayer(),i=o.scaleX(),a={x:(t.x-o.x())/i,y:(t.y-o.y())/i},c=this.props.getObjectAbsolutePosition(this.props.object.id),l=a.x-(e+c.x),p=a.y-(n+c.y),f=Math.atan2(-p*r,l);p>=0&&(f=2*Math.PI+f),this.lastPos=f,this.refs.group.setAttrs(u(s({},this.props,{port:s({},this.props.port,{position:f})}))),this.props.updatePort(this.props.port.id,{position:this.lastPos},!0)}}},{key:"handleDragEnd",value:function(){this.isMoving&&this.props.updatePort(this.props.port.id,{position:this.lastPos}),this.refs.group.cache(),this.isMoving=!1}},{key:"handleDblClick",value:function(){this.isMoving=!0,this.refs.group.startDrag()}},{key:"render",value:function(){var t=u({object:this.props.object,port:this.props.port}),e=this.props.port.name||this.props.port.type[0]+" "+this.props.port.id,n=10*e.length/2,r=180===t.rotation?180:90===t.rotation?180:0;return p["default"].createElement(f.Group,s({},t,{draggable:!0,name:"port port-"+this.props.port.id,id:this.props.port.id,ref:"group",visible:this.props.visible,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDragMove,onDblClick:this.handleDblClick,onDbltTap:this.handleDblClick}),p["default"].createElement(f.Rect,{width:30,height:30,offsetX:15,offsetY:15,fill:"rgba(0,0,0,0)"}),p["default"].createElement(f.Rect,{width:10,height:10,offsetX:5,offsetY:5,fill:"input"===this.props.port.type?"green":"blue",stroke:"darkgrey",strokeHitEnabled:!1}),p["default"].createElement(f.Arrow,{stroke:"white",fill:"white",strokeWidth:1,points:"input"===this.props.port.type?this.inputArrow:this.outputArrow,pointerWidth:3,listening:!1,pointerLength:5}),p["default"].createElement(f.Circle,{x:"input"===this.props.port.type?-12:12,listening:!1,name:"outerConnectPoint"}),p["default"].createElement(f.Circle,{x:"input"===this.props.port.type?6:-6,listening:!1,name:"innerConnectPoint"}),p["default"].createElement(f.Text,{text:e,x:"input"===this.props.port.type?8+n/2:-8-n/2,offsetX:n/2,offsetY:5,fontSize:10,rotation:r,listening:!1,fill:"black"}))}}]),e}(p["default"].Component);e["default"]=d},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(6),l=r(c),p=n(12),f=n(8),h=r(f),d=n(15),v=n(16),g={stroke:"black",strokeWidth:1,name:"connect",pointerWidth:7,fill:"black"},y=function(t){function e(){var t;o(this,e);for(var n=arguments.length,r=Array(n),a=0;n>a;a++)r[a]=arguments[a];var u=i(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.state={points:[]},u.handleClick=u.handleClick.bind(u),u}return a(e,t),s(e,[{key:"componentDidMount",value:function(){this.updatePoints(this.props)}},{key:"componentWillReceiveProps",value:function(t){this.updatePoints(t)}},{key:"shouldComponentUpdate",value:function(t,e){return e.points!==this.state.points}},{key:"updatePoints",value:function(t){var e=[];t.objects.forEach(function(n){var r=h["default"].find(n.ports,function(e){return h["default"].includes(t.ports,e.id)}),o=(0,v.findPortPos)({port:r,object:n}),i=t.getObjectAbsolutePosition(n.id);e.push({x:i.x+o.x,y:i.y+o.y})});var n=e[0].x-e[1].x,r=e[0].y-e[1].y,o=Math.sqrt(Math.pow(n,2)+Math.pow(r,2)),i=(e[1].x-e[0].x)/o,a=(e[1].y-e[0].y)/o,u=6,s=[e[0].x+i*u,e[0].y+a*u,e[1].x-i*u,e[1].y-a*u];h["default"].isEqual(this.state.points,s)||this.setState({points:s})}},{key:"handleClick",value:function(t){var e=t.evt.shiftKey||t.evt.ctrlKey||t.evt.metaKey,n=e||this.props.multipleSelectionMode;this.props.multipleSelectionMode&&this.props.isSelected?this.props.deselectItem(this.props.id):(n||this.props.deselectAll(),this.props.selectConnect(this.props.id,e))}},{key:"render",value:function(){var t=this.props,e=t.isSelected,n=t.hasErrors;return l["default"].createElement(p.Group,{ref:"group",onClick:this.handleClick,onTap:this.handleClick,onMouseEnter:d.showPointer,onMouseLeave:d.hidePointer},l["default"].createElement(p.Line,u({},g,{strokeWidth:10,stroke:"rgba(0,0,0,0.01)",points:this.state.points})),l["default"].createElement(p.Line,u({},g,{points:this.state.points,listening:!1,strokeWidth:e?3:1,stroke:e?"green":n?"red":"black"})))}}]),e}(l["default"].Component);e["default"]=y},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(6),l=r(c),p=n(12),f=function(t){function e(){var t;o(this,e);for(var n=arguments.length,r=Array(n),a=0;n>a;a++)r[a]=arguments[a];var u=i(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.state={endPos:{x:0,y:0},startPos:{x:0,y:0}},u}return a(e,t),s(e,[{key:"componentDidUpdate",value:function(t){if(!t.show&&this.props.show){var e=this.refs.line.getStage(),n=e.findOne(".port-"+this.props.startPortId),r=n.getAbsolutePosition(n.getLayer());this.refs.dragger.setAbsolutePosition(e.getPointerPosition()),this.refs.dragger.startDrag(),this.setState({startPos:r,endPos:r})}}},{key:"handleDragMove",value:function(){this.setState({endPos:this.refs.dragger.position()})}},{key:"hadnleDragEnd",value:function(){var t=this.refs.dragger.getLayer(),e=t.getStage().getPointerPosition(),n=t.getStage().getIntersection(e,".port");n&&this.props.connectPorts(this.props.startPortId,n.id()),this.props.removeTempConnect()}},{key:"render",value:function(){if(!this.props.show)return l["default"].createElement(p.Group,null);var t=this.state,e=t.endPos,n=t.startPos;return l["default"].createElement(p.Group,null,l["default"].createElement(p.Line,{stroke:"black",fill:"black",strokeWidth:1,ref:"line",points:[n.x,n.y,e.x,e.y]}),l["default"].createElement(p.Circle,u({},e,{ref:"dragger",onDragMove:this.handleDragMove.bind(this),onDragEnd:this.hadnleDragEnd.bind(this)})))}}]),e}(l["default"].Component);e["default"]=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(6),l=r(c),p=n(12),f=function(t){function e(){return o(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return a(e,t),s(e,[{key:"componentDidUpdate",value:function(){this.props.show&&!this.refs.dragger.isDragging()&&this.refs.dragger.startDrag()}},{key:"render",value:function(){var t=this;if(!this.props.show)return l["default"].createElement(p.Group,null);var e=this.props.scale;return l["default"].createElement(p.Group,null,l["default"].createElement(p.Rect,{x:this.props.x,y:this.props.y,stroke:"blue",ref:"rect",strokeWidth:1/e}),l["default"].createElement(p.Rect,{x:this.props.x,y:this.props.y,width:8/e,height:8/e,fill:"orange",offset:{x:5/e,y:5/e},ref:"dragger",onDragMove:function(){t.refs.rect.width(t.refs.dragger.x()-t.props.x),t.refs.rect.height(t.refs.dragger.y()-t.props.y)},onDragEnd:function(){t.props.selectObjectsInArea(u({x:t.props.x,y:t.props.y},t.refs.rect.size()))}}))}}]),e}(l["default"].Component);e["default"]=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(6),c=r(s),l=function(t){function e(){return o(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return a(e,t),u(e,[{key:"componentDidUpdate",value:function(t){!t.show&&this.props.show&&this.refs.input.focus()}},{key:"submit",value:function(){var t=this.refs.input.value;this.props.submitPrompt(t),this.props.hidePrompt()}},{key:"handleKeyUp",value:function(t){13===t.keyCode&&this.submit(),27===t.keyCode&&this.props.hidePrompt()}},{key:"render",value:function(){var t=this;return this.props.show?c["default"].createElement("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(255, 255, 255, 0.6)",top:"0px",left:"0px"},ref:"wrap",onClick:function(e){e.target===t.refs.wrap&&t.props.hidePrompt()}},c["default"].createElement("div",{style:{position:"absolute",top:"60px",left:"50%",fontSize:"30px",transform:"translate(-50%, 0)",display:"inline-table"}},"New chip:",c["default"].createElement("input",{ref:"input",style:{width:"250px",fontSize:"30px"},placeholder:"chip name...",onKeyUp:this.handleKeyUp.bind(this)
}),c["default"].createElement("button",{style:{fontSize:"30px"},onClick:this.submit.bind(this)},"Save"),c["default"].createElement("button",{style:{fontSize:"30px"},onClick:this.props.hidePrompt},"Cancel"))):null}}]),e}(c["default"].Component);e["default"]=l},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function o(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(){}Object.defineProperty(e,"__esModule",{value:!0});var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),p=n(6),f=o(p),h=n(12),d=n(8),v=o(d),g=n(15),y=r(g),b=n(13),m=o(b),w=n(17),j=o(w),x=200,O=200,_=function(t){function e(){return i(this,e),a(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),l(e,[{key:"getObjectComponents",value:function(t){var e=this;return t||(t=this.props.objects.filter(function(t){return!t.parent})),t.map(function(t){var n=t.children.map(function(t){return(0,d.find)(e.props.objects,function(e){return e.id===t})});return f["default"].createElement(m["default"],{key:t.id,object:t,isSelected:!1,children:e.getObjectComponents(n),updateObject:s,selectObject:s,createTempConnect:s,resizeObject:s,getObjectAbsolutePosition:s,updatePort:s,trigger:s,drillUp:s,drillDown:s,fitViewport:s,showElementMapper:s,createBookmark:s,onObjectDragMove:s,onObjectDragEnd:s,onObjectDragStart:s,inPreview:!0})})}},{key:"render",value:function(){return f["default"].createElement(h.Group,null,this.getObjectComponents())}}]),e}(f["default"].Component),k=function(t){function e(){return i(this,e),a(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),l(e,[{key:"getConnectComponents",value:function(){var t=this;return this.props.connects.map(function(e){var n=e.ports.map(function(e){var n=t.props.getObjectByPort(e);return c({},n,{visible:!0})});return f["default"].createElement(j["default"],c({},e,{key:e.id,isSelected:!1,selectConnect:s,objects:n,getObjectAbsolutePosition:t.props.getObjectAbsolutePosition}))})}},{key:"render",value:function(){return f["default"].createElement(h.Group,null,this.getConnectComponents())}}]),e}(f["default"].Component),E=function(t){function e(){var t;i(this,e);for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];var u=a(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.requestUpdate=(0,d.throttle)(u.requestUpdate.bind(u),500),u}return u(e,t),l(e,[{key:"shouldComponentUpdate",value:function(t){var e=this,n=["objects","viewport","scale","connects"],r=v["default"].any(n,function(n){return t[n]!==e.props[n]});return r&&this.requestUpdate(),!1}},{key:"requestUpdate",value:function(){this.forceUpdate()}},{key:"render",value:function(){return f["default"].createElement(h.Group,{ref:"group"},f["default"].createElement(h.Group,{x:-this.props.viewport.minX*this.props.scale,y:-this.props.viewport.minY*this.props.scale,scaleX:this.props.scale,scaleY:this.props.scale},f["default"].createElement(_,this.props),f["default"].createElement(k,this.props)))}}]),e}(f["default"].Component),P=function(t){function e(){var t;i(this,e);for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];var u=a(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.state={dx:u.props.x,dy:u.props.y},u.handleDragMove=u.handleDragMove.bind(u),u.handleDragEnd=u.handleDragEnd.bind(u),u}return u(e,t),l(e,[{key:"componentDidMount",value:function(){this.refs.dragger.startDrag()}},{key:"handleDragMove",value:function(t){var e=t.target,n=t.target.getStage(),r=Math.min(e.x(),n.width()),o=Math.min(e.y(),n.height()),i=r-this.props.x,a=o-this.props.y;i/a<this.props.ratio?a=i/this.props.ratio:i=a*this.props.ratio,this.setState({dx:this.props.x+i,dy:this.props.y+a})}},{key:"handleDragEnd",value:function(){var t={x:this.props.x,y:this.props.y,width:this.state.dx-this.props.x,height:this.state.dy-this.props.y};t.width<0&&(t.x+=t.width,t.width*=-1),t.height<0&&(t.y+=t.height,t.height*=-1),this.props.select(t)}},{key:"render",value:function(){return f["default"].createElement(h.Group,null,f["default"].createElement(h.Rect,{x:this.props.x,y:this.props.y,width:this.state.dx-this.props.x,height:this.state.dy-this.props.y,opacity:.7,stroke:"black",strokeWidth:1,fill:"yellow"}),f["default"].createElement(h.Circle,{ref:"dragger",x:this.state.dx,y:this.state.dy,onDragMove:this.handleDragMove,onDragEnd:this.handleDragEnd}))}}]),e}(f["default"].Component),M=function(t){function e(){var t;i(this,e);for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];var u=a(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.state={showSelector:!1,x:0,y:0},u.isScreenDrag=!1,u.handleDragStart=u.handleDragStart.bind(u),u.handleSelectEnd=u.handleSelectEnd.bind(u),u.handleScreenDragMove=u.handleScreenDragMove.bind(u),u.handleMouseMove=u.handleMouseMove.bind(u),u.requestWindowUpdate=(0,d.debounce)(u.requestWindowUpdate.bind(u),500),u}return u(e,t),l(e,[{key:"componentDidMount",value:function(){var t=this,e=this.refs.stage.node.getContent();e.parentNode.style["float"]="left",e.oncontextmenu=function(){return!1};var n=this.getSize(),r=n.height;n.width;window.$(this.refs.window).jqxWindow({isModal:!1,resizable:!1,autoOpen:!0,showCloseButton:!1,position:{x:window.innerWidth-x-40,y:window.innerHeight-O-40}}),window.$(this.refs.scaleSlider).jqxSlider({orientation:"vertical",height:r+"px",width:"25px",mode:"fixed",step:.01,min:0,max:1}).on("change",function(e){t.props.changeScaleLevel(e.args.value)}),this.requestWindowUpdate()}},{key:"componentDidUpdate",value:function(){this.requestWindowUpdate()}},{key:"requestWindowUpdate",value:function(){var t=this.props.viewport,e=t.maxScale,n=t.minX,r=t.maxX,o=t.minY,i=t.maxY,a=this.props.width/(r-n),u=this.props.height/(i-o),s=Math.max(a,u)/10,c=this.getSize(),l=c.width,p=c.height;window.$(this.refs.window).jqxWindow({width:l+29,height:p+27+2}),window.$(this.refs.scaleSlider).jqxSlider({height:p+"px",width:"25px",value:this.props.viewport.scale,min:s,max:e})}},{key:"getSize",value:function(){var t=this.props.viewport,e=t.maxX-t.minX,n=t.maxY-t.minY,r=Math.min(x/e,O/n);return{width:e*r,height:n*r,scale:r}}},{key:"handleDragStart",value:function(t){t.target.stopDrag(),this.setState({showSelector:!0,x:t.target.getStage().getPointerPosition().x,y:t.target.getStage().getPointerPosition().y})}},{key:"handleSelectEnd",value:function(t){var e=this.getSize(),n=e.scale,r=this.props.viewport,o=r.minX+t.x/n,i=r.minY+t.y/n,a=t.height/n/(this.props.viewport.maxY-this.props.viewport.minY),u=this.props.height/((this.props.viewport.maxY-this.props.viewport.minY)*a);this.setState({showSelector:!1}),this.props.updateViewport({x:o,y:i,scale:u})}},{key:"handleScreenDragMove",value:function(){var t=this.refs.virtualScreen,e=this.props.viewport;t.x(Math.min(Math.max(t.x(),e.minX),e.maxX-this.props.width/e.scale)),t.y(Math.min(Math.max(t.y(),e.minY),e.maxY-this.props.height/e.scale)),this.props.updateViewport(t.position())}},{key:"handleMouseMove",value:function(t){}},{key:"render",value:function(){var t=this.props.viewport,e=this.getSize(),n=e.width,r=e.height,o=e.scale;return f["default"].createElement("div",{ref:"window"},f["default"].createElement("div",null,"Overview"),f["default"].createElement("div",{style:{overflow:"hidden",padding:"1px",backgroundColor:"rgb(209, 209, 209)"}},f["default"].createElement("div",{ref:"scaleSlider",style:{"float":"left"}}),f["default"].createElement(h.Stage,{width:n,height:r,ref:"stage"},f["default"].createElement(h.Layer,{ref:"objectsLayer",name:"preview"},f["default"].createElement(E,c({},this.props,{scale:o}))),f["default"].createElement(h.Layer,{onMouseEnter:y.showScaleCursor,onMouseLeave:y.hidePointer,onMouseMove:this.handleMouseMove,name:"preview-tools"},f["default"].createElement(h.Rect,{x:0,y:0,width:n,height:r,opacity:.1,draggable:!0,onDragStart:this.handleDragStart}),f["default"].createElement(h.Group,{x:-t.minX*o,y:-t.minY*o,scaleX:o,scaleY:o},f["default"].createElement(h.Rect,{ref:"virtualScreen",x:t.x,y:t.y,width:this.props.width/t.scale,height:this.props.height/t.scale,opacity:.3,fill:"blue",onMouseEnter:y.showPointer,onMouseLeave:y.showScaleCursor,onDragMove:this.handleScreenDragMove,draggable:!0})),this.state.showSelector?f["default"].createElement(P,{x:this.state.x,y:this.state.y,select:this.handleSelectEnd,ratio:this.props.width/this.props.height}):null))))}}]),e}(f["default"].Component);e["default"]=M},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(6),l=r(c),p=n(12),f=n(15),h=10,d=5,v={fill:"grey",shadowBlur:5,draggable:!0},g=function(t){function e(){var t;o(this,e);for(var n=arguments.length,r=Array(n),a=0;n>a;a++)r[a]=arguments[a];var u=i(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.handleVerScrollMove=u.handleVerScrollMove.bind(u),u.handleHorScrollMove=u.handleHorScrollMove.bind(u),u}return a(e,t),s(e,[{key:"shouldComponentUpdate",value:function(){return!(this.refs.ver.isDragging()||this.refs.hor.isDragging())}},{key:"handleVerScrollMove",value:function(){var t=this.props.viewport,e=t.maxY-t.minY,n=this.refs.ver.y()/this.props.height*e+t.minY;this.props.updateViewport({y:n})}},{key:"handleHorScrollMove",value:function(){var t=this.props.viewport,e=t.maxX-t.minX,n=this.refs.hor.x()/this.props.width*e+t.minX;this.props.updateViewport({x:n})}},{key:"render",value:function(){var t=this,e=this.props.viewport,n=e.maxY-e.minY,r=this.props.height/n*this.props.height/e.scale,o=(e.y-e.minY)/n*this.props.height,i=e.maxX-e.minX,a=this.props.width/i*this.props.width/e.scale,s=(e.x-e.minX)/i*this.props.width;return l["default"].createElement(p.Group,{onMouseEnter:f.showPointer,onMouseLeave:f.hidePointer},l["default"].createElement(p.Rect,u({},v,{ref:"ver",x:this.props.width-h-d,y:o,width:h,height:r,onDragMove:this.handleVerScrollMove,dragBoundFunc:function(e){return{x:t.props.width-h-d,y:Math.max(0,Math.min(t.props.height-r,e.y))}}})),l["default"].createElement(p.Rect,u({},v,{ref:"hor",x:s,y:this.props.height-h-d,width:a,height:h,onDragMove:this.handleHorScrollMove,dragBoundFunc:function(e){return{x:Math.max(0,Math.min(t.props.width-a,e.x)),y:t.props.height-h-d}}})))}}]),e}(l["default"].Component);e["default"]=g},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(6),c=r(s),l=n(12),p=function(t){function e(){return o(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return a(e,t),u(e,[{key:"shouldComponentUpdate",value:function(){return!(this.refs.dragger&&this.refs.dragger.isDragging())}},{key:"componentDidUpdate",value:function(){this.props.show&&(this.refs.dragger.startDrag(),this.lastPos=this.refs.dragger.position())}},{key:"handleDragMove",value:function(){var t=this.lastPos.x-this.refs.dragger.x(),e=this.lastPos.y-this.refs.dragger.y(),n=this.props.viewport;this.props.updateViewport({x:n.x+t/n.scale,y:n.y+e/n.scale}),this.lastPos=this.refs.dragger.position()}},{key:"handleDragEnd",value:function(){this.props.deletePanDragger()}},{key:"render",value:function(){return this.props.show?c["default"].createElement(l.Group,null,c["default"].createElement(l.Circle,{x:this.props.x,y:this.props.y,ref:"dragger",onDragMove:this.handleDragMove.bind(this),onDragEnd:this.handleDragEnd.bind(this)})):c["default"].createElement(l.Group,null)}}]),e}(c["default"].Component);e["default"]=p},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){return t.show?a["default"].createElement(u.Label,{x:t.x,y:t.y-10,listening:!1},a["default"].createElement(u.Tag,{fill:"black",pointerDirection:"down",pointerWidth:5,pointerHeight:5,lineJoin:"round",shadowColor:"black",opacity:.6,shadowBlur:10,shadowOffset:10,shadowOpacity:.5}),a["default"].createElement(u.Text,{text:t.text,padding:3,fill:"white"})):a["default"].createElement(u.Label,null)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o;var i=n(6),a=r(i),u=n(12)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(8),p=r(l),f=n(6),h=r(f),d=n(26),v=r(d),g=n(27),y=r(g),b=n(28),m=r(b),w=n(29),j=r(w),x=n(30),O=r(x),_=window.$,k=function(t){function e(){var t;i(this,e);for(var n=arguments.length,r=Array(n),o=0;n>o;o++)r[o]=arguments[o];var u=a(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.objectClone=p["default"].cloneDeep(u.props.object),u}return u(e,t),c(e,[{key:"componentDidMount",value:function(){var t=this;_(this.refs.window).jqxWindow({isModal:!0,resizable:!1,autoOpen:!1,height:550,width:810,initContent:this.initSubComponents.bind(this)}),_(this.refs.window).on("close",function(){t.close()}),_(this.refs.window).jqxWindow("open")}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"initSubComponents",value:function(){var t=this;this.$(".advanced-properties-tabs").jqxTabs({width:790,height:480}),this.$(".buttonMapperOk").jqxButton({width:"150"}),this.$(".buttonMapperCancel").jqxButton({width:"150"}),this.$(".buttonMapperOk").on("click",function(){t.props.updateObject(t.props.object.id,t.objectClone),t.close()}),this.$(".buttonMapperCancel").on("click",function(){t.close()}),this.updateUI()}},{key:"$",value:function(t){return _(this.refs.window).find(t)}},{key:"updateUI",value:function(){var t=this;this.props.object&&(this.$('[data-isTab="true"]').each(function(e,n){var r=_(n),o=r.data("tab");r.toggle((0,l.includes)(t.props.tabs,o))}),this.$(".advanced-properties-tabs").jqxTabs("select",0))}},{key:"close",value:function(){_(this.refs.window).jqxWindow("destroy"),this.props.hideAdvancedProperties()}},{key:"shouldShowTab",value:function(t){return p["default"].includes(this.props.tabs,t)}},{key:"render",value:function(){var t=this,e=void 0,n=void 0,r=void 0,o=void 0,i=void 0,a=void 0,u=void 0,c=void 0;this.shouldShowTab("info")&&(e=h["default"].createElement("li",null,"General info"),n=h["default"].createElement(v["default"],s({},this.props,{object:this.objectClone}))),this.shouldShowTab("ports")&&(r=h["default"].createElement("li",null,"Ports"),o=h["default"].createElement(y["default"],s({},this.props,{object:this.objectClone}))),this.shouldShowTab("elementMapper")&&(i=h["default"].createElement("li",null,"Element Mapper"),a=h["default"].createElement(m["default"],s({},this.props,{object:this.objectClone}))),this.shouldShowTab("outputDataEditor")&&(u=h["default"].createElement("li",null,"Element Mapper"),c=h["default"].createElement(j["default"],s({},this.props,{object:this.objectClone})));var l=this.props.object.additionalPanels.map(function(t){return h["default"].createElement("li",null,t.Name)}),p=this.props.object.additionalPanels.map(function(e){return h["default"].createElement(O["default"],s({},t.props,{object:t.objectClone,panel:e}))});return h["default"].createElement("div",{ref:"window",style:{position:"absolute",top:"8px",left:"70px"}},h["default"].createElement("div",null,"Advanced properties"),h["default"].createElement("div",{style:{overflow:"hidden"}},h["default"].createElement("div",{className:"advanced-properties-tabs"},h["default"].createElement("ul",{style:{marginLeft:"20px"}},e,r,i,u,l),n,o,a,c,p),h["default"].createElement("table",{border:"0",align:"center",style:{margin:"auto"}},h["default"].createElement("tbody",null,h["default"].createElement("tr",null,h["default"].createElement("td",null,h["default"].createElement("input",{type:"button",value:"OK",className:"buttonMapperOk"})),h["default"].createElement("td",null,h["default"].createElement("input",{type:"button",value:"Cancel",className:"buttonMapperCancel"})))))))}}]),e}(h["default"].Component),E=function(t){function e(){return i(this,e),a(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),c(e,[{key:"render",value:function(){var t=this.props.show;if(!t)return null;var e=["info"];return"chip"===this.props.object.type&&e.push("ports"),this.props.object.rules.elementMapperEnabled&&e.push("elementMapper"),this.props.object.rules.outputDataEditorEnabled&&e.push("outputDataEditor"),this.props.object.additionalPanels&&e.push.apply(e,o(this.props.object.additionalPanels)),h["default"].createElement("div",null,h["default"].createElement(k,s({},this.props,{show:t,tabs:e})))}}]),e}(h["default"].Component);e["default"]=E},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(6),c=r(s),l=n(8),p=r(l),f=window.$,h=function(t){function e(){var t;o(this,e);for(var n=arguments.length,r=Array(n),a=0;n>a;a++)r[a]=arguments[a];var u=i(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.state={shouldShowNameTakenError:!1},u.handleNameChange=u.handleNameChange.bind(u),u}return a(e,t),u(e,[{key:"componentDidMount",value:function(){window.$(this.refs.nameInput).on("change keyup",this.handleNameChange.bind(this))}},{key:"handleNameChange",value:function(t){var e=this;this.props.object.name=t.target.value;var n=p["default"].find(this.props.objects,function(t){return t.id===e.props.object.id?!1:t.name===e.props.object.name});f(this.refs.nameInput).css({border:n?"2px solid red":""}),f(this.refs.error).css({display:n?"initial":"none"})}},{key:"getGateType",value:function(){return"chip"===this.props.object.type?null:c["default"].createElement("div",null,"Gate type: ",this.props.object.subType)}},{key:"render",value:function(){return c["default"].createElement("div",{style:{padding:"20px"}},this.getGateType(),c["default"].createElement("div",null,"Name:",c["default"].createElement("input",{defaultValue:this.props.object.name,style:{border:this.state.shouldShowNameTakenError?"2px solid red":""},ref:"nameInput"}),c["default"].createElement("span",{ref:"error",style:{display:"none"}},"this name is already taken")))}}]),e}(c["default"].Component);e["default"]=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(6),p=r(l),f=n(8),h=r(f),d=window.$,v=function(t){function e(){return i(this,e),a(this,Object.getPrototypeOf(e).apply(this,arguments))}return u(e,t),c(e,[{key:"componentDidMount",value:function(){var t={width:388,autoheight:!0,sortable:!0,altrows:!0,enabletooltips:!0,selectionmode:"singlerow",showtoolbar:!0};this.$(".input-ports-grid").jqxGrid(s({},t,{columns:[{text:"Name",datafield:"name",width:194},{text:"Is mandatory",datafield:"isMandatory",columntype:"checkbox",width:194}],editable:this.props.object.rules.canRenameInputPort,rendertoolbar:this.getRenderToolbarFunc("input")})),this.$(".output-ports-grid").jqxGrid(s({},t,{columns:[{text:"Name",datafield:"name"}],editable:this.props.object.rules.canRenameOutputPort,rendertoolbar:this.getRenderToolbarFunc("output")})),this.updateUI()}},{key:"getRenderToolbarFunc",value:function(t){var e=this;return function(n){var r=d('<div style="margin: 5px;" class="toolbal"></div>');n.append(r),d('<input  type="button" value="Add new port" />').jqxButton().addClass("add-"+t+"-button").appendTo(r).on("click",function(){e.handleAddPort(t)}),d('<input type="button" value="Delete Port" style="margin-left: 5px;"/>').addClass("delete-"+t+"-button").appendTo(r).jqxButton().on("click",function(){var n=e.$("."+t+"-ports-grid").jqxGrid("getselectedrowindex"),r=e.$("."+t+"-ports-grid").jqxGrid("getdatainformation").rowscount;if(n>=0&&r>n){var o=e.props.object.ports.filter(function(e){return e.type===t});e.handleDeletePort(o[n].id)}})}}},{key:"handleRowUpdate",value:function(t,e,n){var r=e.id,o=h["default"].find(this.props.object.ports,function(t){return t.id===r});o.name=e.name,o.isMandatory=e.isMandatory,n(!0)}},{key:"$",value:function(t){return d(this.refs.dom).find(t)}},{key:"handleAddPort",value:function(t){for(var e=1,n=void 0;;){n=t+" "+e;var r=h["default"].find(this.props.object.ports,function(e){return e.type===t&&e.name===n});if(!r)break;e+=1}this.props.object.ports.push({id:h["default"].uniqueId(),position:2*Math.PI*Math.random(),name:n,isMandatory:!1,type:t}),this.updateUI()}},{key:"handleDeletePort",value:function(t){var e=h["default"].findIndex(this.props.object.ports,function(e){return e.id===t});this.props.object.ports=[].concat(o(this.props.object.ports.slice(0,e)),o(this.props.object.ports.slice(e+1))),this.updateUI()}},{key:"updateUI",value:function(){var t={datatype:"local",datafields:[{name:"name",type:"string"},{name:"isMandatory",type:"bool"},{name:"id",type:"string"}]};this.$(".input-ports-grid").jqxGrid("source",new d.jqx.dataAdapter(s({},t,{localdata:this.props.object.ports.filter(function(t){return"input"===t.type}),updaterow:this.handleRowUpdate.bind(this)}))),this.$(".output-ports-grid").jqxGrid("source",new d.jqx.dataAdapter(s({},t,{localdata:this.props.object.ports.filter(function(t){return"output"===t.type}),updaterow:this.handleRowUpdate.bind(this)})));var e=this.props.object.ports.filter(function(t){return"output"===t.type}),n=this.props.object.ports.filter(function(t){return"input"===t.type}),r=this.props.object.rules.canAddInputPort&&n.length<this.props.object.rules.maxInputPortsNumber;d(".add-input-button").jqxButton({disabled:!r});var o=this.props.object.rules.canAddOutputPort&&e.length<this.props.object.rules.maxOutputPortsNumber;d(".add-output-button").jqxButton({disabled:!o});var i=this.props.object.rules.canDeleteInputPort&&n.length>this.props.object.rules.minInputPortsNumber;d(".delete-input-button").jqxButton({disabled:!i});var a=this.props.object.rules.canDeleteOutputPort&&e.length>this.props.object.rules.minOutputPortsNumber;d(".delete-output-button").jqxButton({disabled:!a})}},{key:"render",value:function(){return p["default"].createElement("div",null,p["default"].createElement("table",{ref:"dom",border:"0"},p["default"].createElement("tbody",null,p["default"].createElement("tr",null,p["default"].createElement("td",{align:"center"},"Input ports"),p["default"].createElement("td",{align:"center"},"Output ports")),p["default"].createElement("tr",{style:{verticalAlign:"top"}},p["default"].createElement("td",null,p["default"].createElement("div",{className:"input-ports-grid"})),p["default"].createElement("td",null,p["default"].createElement("div",{className:"output-ports-grid"}))))))}}]),e}(p["default"].Component);e["default"]=v},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){if(document.selection){t.focus();var n=document.selection.createRange();n.text=e,t.focus()}else if(t.selectionStart||0===t.selectionStart){var r=t.selectionStart,o=t.selectionEnd,i=t.scrollTop;t.value=t.value.substring(0,r)+e+t.value.substring(o,t.value.length),t.focus(),t.selectionStart=r+e.length,t.selectionEnd=r+e.length,t.scrollTop=i}else t.value+=e,t.focus()}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=n(6),p=r(l),f=n(8),h=r(f),d=window.$,v=function(t){function e(){var t;o(this,e);for(var n=arguments.length,r=Array(n),a=0;n>a;a++)r[a]=arguments[a];var u=i(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.state={selectedRowIndex:null},u}return a(e,t),c(e,[{key:"componentDidMount",value:function(){var t=this;this.$(".inputSearchSource").jqxInput({placeHolder:"Search",height:25,width:200,minLength:1}),this.$(".outputSearchTarget").jqxInput({placeHolder:"Search",height:25,width:200,minLength:1}),this.$(".mapperExpression").jqxInput({placeHolder:"Enter expression(s)",minLength:1,width:"100%",height:100}),this.$(".gridMapperSource").jqxGrid({width:280,height:300,showheader:!1,sortable:!0,selectionmode:"singlerow",columns:[{text:"Object",datafield:"object"},{text:"Name",datafield:"name"},{text:"Type",datafield:"type"}],groups:["object"],rendered:function(){var e=d(".gridMapperSource").find('[role="row"]');e.jqxDragDrop({appendTo:"body",dragZIndex:99999,dropAction:"none",initFeedback:function(t){t.height(25)},dropTarget:t.$(".gridMapperTarget"),revert:!0}),e.off("dragStart"),e.off("dragEnd"),e.off("dropTargetEnter"),e.off("dropTargetLeave"),e.on("dropTargetEnter",function(){e.jqxDragDrop({revert:!1})}),e.on("dropTargetLeave",function(){e.jqxDragDrop({revert:!0})});var n=void 0;e.on("dragStart",function(e){var r=d.jqx.position(e.args),o=t.$(".gridMapperSource").jqxGrid("getcellatposition",r.left,r.top);n=o.row}),e.on("dragEnd",function(e){if(0!==t.props.object.outputData.length){var r=d.jqx.position(e.args),o=t.$(".gridMapperTarget").jqxGrid("getcellatposition",r.left,r.top),i=t.$(".gridMapperTarget")[0].getBoundingClientRect(),a=r.left>i.left&&r.left<i.left+i.width&&r.top>i.top&&r.top<i.top+i.height;if(a){var u=o&&void 0!==o.row&&o.row;h["default"].isNumber(u)&&t.mapPorts(n,u)}}})}}),this.$(".gridMapperTarget").jqxGrid({width:280,height:300,showheader:!1,sortable:!0,editmode:"dblclick",columns:[{text:"Name",datafield:"name"},{text:"Type",datafield:"type"}],showtoolbar:this.shouldShowToolbar(),rendertoolbar:function(e){var n=d('<div style="margin: 5px;" class="toolbal"></div>');e.append(n),d('<input type="button" value="Add New Row" />').appendTo(n).addClass("add-output-row-button").jqxButton().on("click",function(){t.addOutputRow()}),d('<input style="margin-left: 5px;" type="button" value="Delete Selected Row" />').appendTo(n).addClass("delete-output-row-button").jqxButton().on("click",function(){
var e=t.$(".gridMapperTarget").jqxGrid("getselectedrowindex"),n=t.$(".gridMapperTarget").jqxGrid("getdatainformation").rowscount;e>=0&&n>e&&t.removeOutputRow(e)})}}),this.$(".gridMapperTarget").on("rowselect",function(e){t.setState({selectedRowIndex:e.args.rowindex})});var e=h["default"].debounce(function(){t.updateUI()},500);this.$(".mapperExpression").on("change keyup",h["default"].debounce(function(){t.state.selectedRowIndex<0||void 0===t.state.selectedRowIndex||(t.props.object.outputData[t.state.selectedRowIndex].source=t.$(".mapperExpression").val(),e())})),this.$(".toolbal").parent().toggle(this.shouldShowToolbar());var n=[],r=this.props.getObjectInputs(this.props.object.id);r.length>0&&(n.push({id:"inputs",text:"Input data",parentid:"-1"}),r.forEach(function(e){var r=h["default"].find(n,function(t){return t.id===e.object.id});r||n.push({id:e.object.id,text:e.object.name,parentid:"inputs"}),n.push({id:e.name,text:e.name,parentid:e.object.id,actionId:h["default"].uniqueId(),getData:function(){return t.serilizeInput(e)}})})),h["default"].forOwn(this.props.expressionTree,function(t,e){n.push({id:e,text:e,parentid:"-1"}),h["default"].isArray(t)?t.forEach(function(t){n.push({id:e+"_"+t.Label,text:t.Label,parentid:e,getData:function(){return"$`__Variable`.`VAR`$".replace("VAR",t.Syntax)}})}):h["default"].forOwn(t,function(t,r){n.push({id:e+"_"+r,text:r,parentid:e}),t.forEach(function(t){n.push({id:e+"_"+r+"_"+t.Label,text:t.Label,parentid:e+"_"+r,getData:function(){return t.Syntax}})})})});var o={datatype:"json",datafields:[{name:"id"},{name:"parentid"},{name:"text"},{name:"actionId"},{name:"getData"}],id:"id",localdata:n},i=new d.jqx.dataAdapter(o);i.dataBind();var a=i.getRecordsHierarchy("id","parentid","items",[{name:"text",map:"label"},{name:"getData",map:"value"}]);this.$(".tree").jqxTree({source:a,width:200,height:100}),this.$(".tree").on("itemClick",function(e){var n=e.args,r=t.$(".tree").jqxTree("getItem",n.element);if(r.value&&h["default"].isFunction(r.value)){var o=r.value();if(t.$(".mapperExpression").attr("disabled"))return void alert("Firtst you need to select output row");u(t.$(".mapperExpression")[0],o)}}),this.updateUI()}},{key:"setState",value:function(t){this.state=s({},this.state,t),this.updateUI()}},{key:"getOutputDataRows",value:function(){var t=this.props.object;return t.outputData.map(function(t,e){return{id:e,name:t.name,type:t.type}})}},{key:"getInputDataRows",value:function(){var t=this.props.object;return this.props.getObjectInputs(t.id).map(function(t,e){return{id:e,name:t.name,type:t.type,object:t.object.name}})}},{key:"shouldShowToolbar",value:function(){return"writer"!==this.props.object.subType}},{key:"updateUI",value:function(){this.redrawMap();var t={datatype:"json",datafields:[{name:"name",type:"string"},{name:"type",type:"string"},{name:"id",type:"string"},{name:"object",type:"string"}],id:"id"},e=s({},t,{localdata:this.getInputDataRows()});this.$(".gridMapperSource").jqxGrid("source",new d.jqx.dataAdapter(e));var n=s({},t,{localdata:this.getOutputDataRows(),updaterow:this.handleRowUpdate.bind(this)});if(this.$(".gridMapperTarget").jqxGrid("source",new d.jqx.dataAdapter(n)),this.$(".gridMapperTarget").jqxGrid("editable",this.props.object.rules.canRenameOutputData),null!==this.state.selectedRowIndex){this.$(".mapperExpression").attr("disabled",!1);var r=this.props.object.outputData[this.state.selectedRowIndex].source||"";this.$(".mapperExpression").val()!==r&&this.$(".mapperExpression").val(r)}else this.$(".mapperExpression").attr("disabled",!0);"writer"===this.props.object.subType?this.$(".mapperExpression").hide():this.$(".mapperExpression").show();var o=this.props.object.rules.canAddOutputData;d(".add-output-row-button").jqxButton({disabled:!o});var i=this.props.object.rules.canDeleteOutputData;d(".delete-output-row-button").jqxButton({disabled:!i})}},{key:"addOutputRow",value:function(){for(var t=this,e=1,n=function(){var n="new row"+(1===e?"":e),r=h["default"].any(t.props.object.outputData,function(t){return t.name===n});return r?void(e+=1):"break"};;){var r=n();if("break"===r)break}var o="new row"+(1===e?"":e),i={type:"string",source:"",name:o,id:h["default"].uniqueId()},a=null===this.state.selectedRowIndex?this.props.object.outputData.length:this.state.selectedRowIndex+1;this.props.object.outputData.splice(a,0,i),this.updateUI()}},{key:"removeOutputRow",value:function(t){this.props.object.outputData.splice(t,1),this.state.selectedRowIndex=null,this.updateUI()}},{key:"serilizeInput",value:function(t){return"$`OBJECT`.`INPUT`$".replace("OBJECT",t.object.name).replace("INPUT",t.name)}},{key:"redrawMap",value:function(){var t=this,e=d("#map");e.empty();var n=this.props.getObjectInputs(this.props.object.id),r="",o=28;h["default"].forEach(this.props.object.outputData,function(e,i){if(e.source){var a=h["default"].findIndex(n,function(n){return t.serilizeInput(n)===e.source}),u=-1===a;if(!u){var s="writer"===t.props.object.subType?0:34,c=a*o+o/2,l=i*o+o/2+s;r+='\n                <line x1="'+(u?150:2)+'" y1="'+c+'" x2="198" y2="'+l+'" style="\n                    stroke:'+(u?"red":"rgb(0,0,0)")+';\n                stroke-width:2" />\n            '}}}),e.append('\n            <svg width="200" height="300">\n                '+r+"\n            </svg>\n        ")}},{key:"mapPorts",value:function(t,e){var n=this.props.getObjectInputs(this.props.object.id),r=n[t],o=this.serilizeInput(r);this.props.object.outputData[e].source=o,this.updateUI()}},{key:"handleRowUpdate",value:function(t,e,n){this.props.object.outputData[e.id].name=e.name,this.updateUI(),n(!0)}},{key:"$",value:function(t){return d(this.refs.dom).find(t)}},{key:"render",value:function(){return p["default"].createElement("div",null,p["default"].createElement("table",{ref:"dom",border:"0"},p["default"].createElement("tbody",null,p["default"].createElement("tr",null,p["default"].createElement("td",{align:"center"},p["default"].createElement("input",{type:"text",className:"inputSearchSource"})),p["default"].createElement("td",null),p["default"].createElement("td",{align:"center"},p["default"].createElement("input",{type:"text",className:"outputSearchTarget"}))),p["default"].createElement("tr",null,p["default"].createElement("td",null,p["default"].createElement("div",{className:"gridMapperSource"})),p["default"].createElement("td",null,p["default"].createElement("div",{id:"map"},p["default"].createElement("svg",{width:"200",height:"300"}))),p["default"].createElement("td",null,p["default"].createElement("div",{className:"gridMapperTarget"}))),p["default"].createElement("tr",null,p["default"].createElement("td",{align:"center"},p["default"].createElement("div",{className:"tree"})),p["default"].createElement("td",{colSpan:"2",align:"center"},p["default"].createElement("div",null,p["default"].createElement("input",{name:"txtMapperExpression",className:"mapperExpression",style:{height:"100",width:"100"}})))))))}}]),e}(p["default"].Component);e["default"]=v},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(6),c=r(s),l=n(8),p=r(l),f=window.$,h=function(t){function e(){return o(this,e),i(this,Object.getPrototypeOf(e).apply(this,arguments))}return a(e,t),u(e,[{key:"componentDidMount",value:function(){var t=this;f(this.refs.dom).jqxGrid({width:330,height:400,sortable:!0,columns:[{text:"Name",datafield:"name"},{text:"Type",datafield:"type"}],editable:!0,editmode:"dblclick",showtoolbar:!0,rendertoolbar:function(e){var n=f('<div style="margin: 5px;" class="toolbal"></div>');e.append(n),n.append('<input class="addrowbutton" type="button" value="Add New Row" />'),n.append('<input\n                            style="margin-left: 5px;" class="deleterowbutton"\n                            type="button" value="Delete Selected Row"\n                        />'),t.$(".addrowbutton").jqxButton(),t.$(".deleterowbutton").jqxButton(),t.$(".addrowbutton").on("click",function(){t.addRow()}),t.$(".deleterowbutton").on("click",function(){var e=f(t.refs.dom).jqxGrid("getselectedrowindex"),n=f(t.refs.dom).jqxGrid("getdatainformation").rowscount;e>=0&&n>e&&t.removeRow(e)})}}),this.updateUI()}},{key:"$",value:function(t){return f(this.refs.dom).find(t)}},{key:"addRow",value:function(){for(var t=this,e=1,n=function(){var n="new row"+(1===e?"":e),r=p["default"].any(t.props.object.outputData,function(t){return t.name===n});return r?void(e+=1):"break"};;){var r=n();if("break"===r)break}var o="new row"+(1===e?"":e);this.props.object.outputData.push({type:"string",name:o}),this.updateUI()}},{key:"removeRow",value:function(t){this.props.object.outputData.splice(t,1),this.updateUI()}},{key:"getOutputs",value:function(){return this.props.object.outputData.map(function(t,e){return{id:e,name:t.name,type:t.type}})}},{key:"handleRowUpdate",value:function(t,e,n){this.props.object.outputData[e.id].name=e.name,n(!0),this.updateUI()}},{key:"updateUI",value:function(){var t={datatype:"json",datafields:[{name:"name",type:"string"},{name:"type",type:"string"},{name:"id",type:"string"}],id:"id",localdata:this.getOutputs(),updaterow:this.handleRowUpdate.bind(this)};f(this.refs.dom).jqxGrid("source",new f.jqx.dataAdapter(t));var e=this.props.object.rules.canAddOutputData;this.$(".addrowbutton").jqxButton({disabled:!e});var n=this.props.object.rules.canDeleteOutputData;this.$(".deleterowbutton").jqxButton({disabled:!n}),f(this.refs.dom).jqxGrid("editable",this.props.object.rules.canRenameOutputData)}},{key:"render",value:function(){var t={margin:"auto",marginTop:"10px"};return c["default"].createElement("div",null,c["default"].createElement("div",{ref:"dom",className:"gridMapper",style:t}))}}]),e}(c["default"].Component);e["default"]=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(6),c=r(s),l=n(8),p=(r(l),window.$),f=function(t){function e(){var t;o(this,e);for(var n=arguments.length,r=Array(n),a=0;n>a;a++)r[a]=arguments[a];var u=i(this,(t=Object.getPrototypeOf(e)).call.apply(t,[this].concat(r)));return u.state={shouldShowNameTakenError:!1},u}return a(e,t),u(e,[{key:"componentDidMount",value:function(){var t=this;this.props.panel.Key_Value_Pairs.forEach(function(e){var n=t.$('[data-field="'+e.Name+'"]');if(("Textbox"===e.Type||"Password"===e.Type)&&n.on("change",function(){var r=n.val();t.props.object.customAttributes[e.Name]=r}),"Checkbox"===e.Type&&n.on("change",function(){var r=n.is(":checked");t.props.object.customAttributes[e.Name]=r}),"Listbox"===e.Type){var r=t.props.object.customAttributes[e.Name];n.jqxComboBox({source:e.Values,selectedIndex:e.Values.indexOf(r)}),n.on("select",function(n){var r=e.Values[n.args.index];console.log("new val",r),t.props.object.customAttributes[e.Name]=r})}})}},{key:"$",value:function(t){return p(this.refs.content).find(t)}},{key:"render",value:function(){var t=this.props.object,e=this.props.panel.Key_Value_Pairs.map(function(e){var n=void 0;return"Textbox"===e.Type?n=c["default"].createElement("input",{type:"text",defaultValue:t.customAttributes[e.Name],"data-field":e.Name}):"Checkbox"===e.Type?n=c["default"].createElement("input",{type:"checkbox",checked:t.customAttributes[e.Name],"data-field":e.Name}):"Password"===e.Type?n=c["default"].createElement("input",{type:"password",defaultValue:t.customAttributes[e.Name],"data-field":e.Name}):"Listbox"===e.Type?n=c["default"].createElement("div",{"data-field":e.Name}):console.error("Unknow propery type "+e.Type),c["default"].createElement("div",null,e.Name,":"," ",n)});return c["default"].createElement("div",{style:{padding:"20px"},ref:"content"},c["default"].createElement("div",null,e))}}]),e}(c["default"].Component);e["default"]=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){function e(t){r.push(u({},t))}function n(e){return c["default"].find(t.objects,function(t){return c["default"].find(t.ports,function(t){return t.id===e})})}var r=[];return t.connects.forEach(function(r){var o=a(r.ports,2),u=o[0],s=o[1],l=n(u),p=n(s);if(l===p&&"gate"===l.type)return void e({description:"Port of same object can not be connected",targetId:r.id});var f=c["default"].find(l.ports,function(t){return t.id===u}),h=c["default"].find(p.ports,function(t){return t.id===s}),d=n(u),v=n(s),g="input"===f.type?f:"input"===h.type?h:null,y="output"===f.type?f:"output"===h.type?h:null,b=g&&n(g.id),m=(y&&n(y.id),d.type===v.type),w=d.parent===v.parent;if(m&&!w&&"gate"===d.type)return void e({description:"Can not connect two objects on different parent",targetId:r.id});var j=d.parent===v.parent;if(j&&(!g||!y))return void e({description:"Can not connect ports of same type",targetId:r.id});var x=d.parent===v.id||v.parent===d.id;if(!j&&!x)return void e({description:"Connected objects must be in child-parent relationship.",targetId:r.id});if(x&&f.type!==h.type)return void e({description:"GATE and CHIP port must have same type",targetId:r.id});if(x&&y){var O=function(){var o=d.parent===v.id?v:d,i=c["default"].includes(o.ports,f)?f:h,a=c["default"].find(t.connects,function(t){if(t===r)return!1;var e=i.id===t.ports[0];if(e){var a=n(t.ports[1]);return a.parent===o.id}var u=i.id===t.ports[1];if(u){var s=n(t.ports[0]);return s.parent===o.id}return!1}),u="output"===f.type&&"output"===h.type;return u&&a?(e({description:"Output port of parent CHIP already connected",targetId:r.id}),{v:void 0}):void 0}();if("object"===("undefined"==typeof O?"undefined":i(O)))return O.v}if(x&&y){var _=function(){var o=d.parent===v.id?v:d,i=c["default"].includes(o.ports,f)?f:h,a=c["default"].find(t.connects,function(t){if(t===r)return!1;var e=i.id===t.ports[0];if(e){var a=n(t.ports[1]);return a.id===o.id}var u=i.id===t.ports[1];if(u){var s=n(t.ports[0]);return s.id===o.id}return!1}),u="output"===f.type&&"output"===h.type;return u&&a?(e({description:"Output port of chip can have only on inbound connection",targetId:r.id}),{v:void 0}):void 0}();if("object"===("undefined"==typeof _?"undefined":i(_)))return _.v}if(x){var k="input"===f.type&&"input"===h.type,E="output"===f.type&&"output"===h.type,P=d.parent===v.id?v:d;if(k&&"IC 555"===P.subType)return void e({description:"Input of CHIP[IC 555] can not have inbound connections",targetId:r.id});if(E&&"IC 555"===P.subType)return void e({description:"Input of CHIP[IC 555] can not have inbound connections",targetId:r.id})}if(g&&!x&&"connector"!==b.subType){var M=c["default"].find(t.connects,function(t){if(t===r)return!1;var e=c["default"].includes(t.ports,g.id);if(!e)return!1;var o=t.ports[0]===g.id?t.ports[1]:t.ports[0],i=n(o),a=n(g.id),u=i.parent===a.id;return u?!1:!0});if(M)return void e({description:"Input already connected.",targetId:r.id})}var C="connector"===d.subType&&"connector"===v.subType;return C?void e({description:"Can not connect two CONNECTOR objects.",targetId:r.id}):("output"!==f.type||new RegExp(l.rules.outputPortValidation).test(p.subType.toLowerCase()))&&("output"!==h.type||new RegExp(p.rules.outputPortValidation).test(l.subType.toLowerCase()))?("input"!==f.type||new RegExp(l.rules.inputPortValidation).test(p.subType.toLowerCase()))&&("input"!==h.type||new RegExp(p.rules.inputPortValidation).test(l.subType.toLowerCase()))?void 0:void e({description:"Input validation don`t passed.",targetId:r.id}):void e({description:"Output validation don`t passed.",targetId:r.id})}),t.objects.forEach(function(n){var r=c["default"].find(t.objects,function(t){return t===n?!1:t.name===n.name});r&&e({description:"Name is not unique",targetId:n.id})}),r}Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(s){o=!0,i=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e["default"]=o;var s=n(8),c=r(s)}]);